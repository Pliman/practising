<HTML xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<HEAD>
<META http-equiv="Content-Type" content="text/html;Charset=gb2312">
<META name="GENERATOR content="网络程序员伴侣(Lshdic)2005">
<META name="KeyWords" content="flashvml; 闪耀之星; vml; VML; vmlflash; vml动画; 矢量; 2D; 3D; 沐缘华; FYW; 画板; 在线画图">
<title>FlashVml(闪耀之星)3.0 - 基于WEB运行的图像设计、3D网页设计、动画设计、VML最强开发工具</title>
<STYLE>
v\:*{behavior:url(#default#VML);}o\:*{behavior:url(#default#VML);}
select,input,button,textarea{font-size:12px}
a{text-Decoration:none;color:red}
a:hover{text-Decoration:underline;color:blue;}
table{background-color:#FCDCF1;}
td{font-size:12px;color:555555;}
span{font-size:12px;white-Space:nowrap;}
.bon1{border-bottom:1 solid eeeeee;border-right:1 solid eeeeee;border-left:1 solid gray;border-top:1 solid gray;background-color:dddddd;color:blue;width:48;cursor:hand;}
.bon2{border-bottom:1 solid gray;border-right:1 solid gray;border-left:1 solid white;border-top:1 solid white;background-color:#FCDCF1;color:maroon;width:48;cursor:hand;font-family:宋体;}
.bon3{border-bottom:1 solid maroon;border-right:1 solid maroon;border-left:1 solid menu;border-top:1 solid menu;background-color:#F0E5D1;color:purple;width:54;cursor:hand;font-family:宋体;}
textarea{border:1 groove purple;}
#cen{color:maroon;font-weight:bold;width:100%;height:100%;cursor:move}
#xiaolei{color:red}
.keshi{position:absolute;z-index:30000;}
.zhongyao{cursor:hand;font-weight:bold;color:red}
</STYLE>
</HEAD>
<BODY onscroll='bodyscrollleft=document.body.scrollLeft;bodyscrolltop=document.body.scrollTop;if(scrolltime==null&&huaban_scroll==true)scrolltime=setTimeout("movegongjulan()",500)' oncontextmenu='if(event.srcElement.tagName!="TEXTAREA"){if(event.srcElement.tagName=="INPUT"){if(event.srcElement.type=="text")return true}return false}' style='margin:0;cursor:default;border:0;scrollbar-base-color:purple;scrollbar-shadow-color:white;scrollbar-highlight-color:white;scrollbar-arrow-color:white;' vlink=#3732CD link='#3732CD' onselectstart='if(event.srcElement.tagName!="TEXTAREA"&&event.srcElement.tagName!="INPUT")return false' onhelp='helplai();return false'>
<base target='_blank'>
<script>
var bodyscrollleft=0,bodyscrolltop=0 
var filesize1=document.fileSize
var scrolltime=null
function window.onerror(){  //防止未加载完成时触发事件错误
return true
}
function jiazai(jiazaitext){
window.status="FlashVml3.0("+filesize1+"字节) -- "+jiazaitext+"资料加载中...."
}
jiazai("开场动画")
function movegongjulan(){ 
gongjulan1.style.left=bodyscrollleft+document.body.offsetWidth/2-(gongjulan1.offsetWidth/2)
gongjulan2.style.left=bodyscrollleft+document.body.offsetWidth-gongjulan2.offsetWidth-20
gongjulan3.style.left=bodyscrollleft+3;
gongjulan2.style.top=bodyscrolltop
gongjulan3.style.top=bodyscrolltop+25
juzhenmove() 
clearTimeout(scrolltime);scrolltime=null
}
function window.onresize(){
if(scrolltime==null&&huaban_scroll==true)scrolltime=setTimeout("movegongjulan()",500)
}
</script>
<DIV style='position:absolute;z-index:4000;top:500;display:none;zoom:0.8' id=meinv>
<v:curve style="Z-INDEX:3001;LEFT:356;POSITION:absolute;TOP:198;" control1="75pt,-19pt" control2="95pt,-16pt" to="96.75pt,-12pt" fillcolor="black"> <v:fill opacity=".5"/></v:curve><v:curve style="Z-INDEX:3007;LEFT:543;POSITION:absolute;TOP:179" control1="-3pt,-11.25pt" control2="48pt,-19pt" to="56.25pt,-17.25pt" fillcolor="black"><v:fill opacity=".5"/></v:curve><v:curve style="Z-INDEX:3010;LEFT:386;POSITION:absolute;TOP:232" control1="11pt,-3pt" control2="48pt,-22pt" to="65.25pt,-9pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3026;LEFT:386;POSITION:absolute;TOP:233" control1="40pt,23pt" control2="65.25pt,-8.25pt" to="64.5pt,-9.75pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3037;LEFT:546;POSITION:absolute;TOP:212" control1="11pt,-20pt" control2="44.25pt,-14.25pt" to="46.5pt,-15pt" filled="f"/><v:curve style="Z-INDEX:3042;LEFT:546;POSITION:absolute;TOP:211" control1="48.75pt,11.25pt" control2="46.5pt,-14.25pt" to="46.5pt,-14.25pt" filled="f" strokecolor="#555"/><v:polyline style="Z-INDEX:3063;LEFT:548;POSITION:absolute;TOP:211" points="0,0,3pt,-5.25pt,8.25pt,-9pt,13.5pt,-11.25pt,22.5pt,-13.5pt,31.5pt,-14.25pt,39pt,-14.25pt,42pt,-6.75pt,41.25pt,-4.5pt,36.75pt,-.75pt,30.75pt,1.5pt,23.25pt,2.25pt,16.5pt,2.25pt,9pt,2.25pt,0,0" fillcolor="#4338e8" strokecolor="#555"><v:fill opacity=".5"/></v:polyline><v:polyline style="Z-INDEX:3082;LEFT:400;POSITION:absolute;TOP:227" points="0,0,0,3.75pt,2.25pt,9pt,3.75pt,9.75pt,10.5pt,12pt,15.75pt,12.75pt,26.25pt,12.75pt,33.75pt,10.5pt,42.75pt,6pt,48.75pt,.75pt,44.25pt,-8.25pt,36pt,-9.75pt,26.25pt,-8.25pt,15.75pt,-5.25pt,0,0" fillcolor="#4338e8" strokecolor="#555"><v:fill opacity=".5"/></v:polyline><v:arc style="Z-INDEX:3107;LEFT:546;WIDTH:41;CLIP:rect(4 38 23 0);POSITION:absolute;TOP:189;HEIGHT:23" startangle="238" endangle="27" fillcolor="black" stroked="f"><v:fill opacity=".5"/></v:arc><v:arc style="Z-INDEX:3107;LEFT:406;WIDTH:35;CLIP:rect(0 35 22 0);POSITION:absolute;TOP:215;HEIGHT:23" startangle="278" endangle="32" fillcolor="black" stroked="f"><v:fill opacity=".5"/></v:arc><v:oval style="Z-INDEX:3153;LEFT:413;WIDTH:5;POSITION:absolute;TOP:225;HEIGHT:5" stroked="f"><v:fill opacity="52428f"/></v:oval><v:oval style="Z-INDEX:3153;LEFT:559;WIDTH:5;POSITION:absolute;TOP:203;HEIGHT:5" stroked="f"><v:fill opacity="45875f"/></v:oval><v:curve style="Z-INDEX:3166;LEFT:377;POSITION:absolute;TOP:228" control1="18pt,-13.5pt" control2="64.5pt,-13.5pt" to="51pt,-13.5pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3171;LEFT:560;POSITION:absolute;TOP:195" control1="27pt,-10.5pt" control2="41.25pt,-6pt" to="41.25pt,-6pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3012;LEFT:536;POSITION:absolute;TOP:231" control1="26pt,40pt" control2="12.75pt,40.5pt" to="12.75pt,40.5pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3018;LEFT:522;POSITION:absolute;TOP:315" control1="44.25pt,-9pt" control2="44.25pt,-9pt" to="44.25pt,-9pt" fillcolor="red"><v:fill opacity=".5"/></v:curve><v:curve style="Z-INDEX:3029;LEFT:522;POSITION:absolute;TOP:315" control1="18pt,-9pt" control2="15pt,-9pt" to="27.75pt,-7.5pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3032;LEFT:559;POSITION:absolute;TOP:304" control1="9pt,-7pt" control2="8pt,1pt" to="16.5pt,-1.5pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3079;LEFT:523;POSITION:absolute;TOP:315" control1="20pt,4pt" control2="20pt,4pt" to="27pt,3.75pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3086;LEFT:559;POSITION:absolute;TOP:320" control1="7pt,-3pt" control2="7pt,-2pt" to="15.75pt,-12.75pt" filled="f" strokecolor="#555"/><v:polyline style="Z-INDEX:3111;LEFT:524;POSITION:absolute;TOP:313" points="0,0,11.25pt,-4.5pt,17.25pt,-6.75pt,26.25pt,-6pt,27pt,-7.5pt,32.25pt,-9.75pt,38.25pt,-7.5pt,42pt,-8.25pt,37.5pt,-3pt,31.5pt,3pt,26.25pt,5.25pt,17.25pt,4.5pt,-.75pt,1.5pt,0,0" fillcolor="red" stroked="f"><v:fill opacity=".5"/></v:polyline><v:line style="Z-INDEX:3132;LEFT:403;POSITION:absolute;TOP:240" to="-7.5pt,7.5pt" strokecolor="#555"></v:line><v:line style="Z-INDEX:3133;LEFT:410;POSITION:absolute;TOP:242" to="-9pt,12.75pt" strokecolor="#555"></v:line><v:line style="Z-INDEX:3134;LEFT:600;POSITION:absolute;TOP:207" to="12.75pt,4.5pt" strokecolor="#555"></v:line><v:line style="Z-INDEX:3135;LEFT:605;POSITION:absolute;TOP:200" to="14.25pt,2.25pt" strokecolor="#555"></v:line><v:Textbox id=mmtishi style="display:none;FONT-SIZE:20;Z-INDEX:3157;LEFT:324;WIDTH:394;COLOR:red;WORD-BREAK:break-all;FONT-FAMILY:黑体;LETTER-SPACING:2;POSITION:absolute;TOP:412;HEIGHT:73;TEXT-ALIGN:center" inset="5pt,5pt,5pt,5pt">FlashVml程序加载完成 <BR>可以使用<BR><FONT color=blue>&#169;CopyRight2004-2005 沐缘华</FONT></v:Textbox><v:curve style="Z-INDEX:3178;LEFT:620;POSITION:absolute;TOP:131" control1="8pt,162pt" control2="-46pt,162pt" to="-52.5pt,164.25pt" filled="f" strokecolor="#555"/><v:curve style="Z-INDEX:3208;LEFT:345;POSITION:absolute;TOP:221" control1="120pt,129.75pt" control2="175.5pt,117.75pt" to="154.5pt,116.25pt" filled="f"/><v:curve style="Z-INDEX:3212;LEFT:381;POSITION:absolute;TOP:282" control1="107.25pt,97.5pt" control2="180.75pt,84pt" to="180.75pt,84pt" filled="f"/><v:curve style="Z-INDEX:3215;LEFT:413;POSITION:absolute;TOP:328" control1="107.25pt,1in" control2="186pt,54.75pt" to="186pt,54.75pt" filled="f"/><v:curve style="Z-INDEX:3222;LEFT:339;POSITION:absolute;TOP:261" control1="168.75pt,127.5pt" control2="261pt,95.25pt" to="261pt,95.25pt" filled="f"/><v:curve style="Z-INDEX:3249;LEFT:319;POSITION:absolute;TOP:157" control1="123.75pt,189.75pt" control2="271.5pt,166.5pt" to="271.5pt,166.5pt" filled="f"/></div>

<v:roundrect id=helptool style="Z-INDEX:90000;LEFT:409;WIDTH:159;POSITION:absolute;TOP:-280;HEIGHT:253;display:none" arcsize=9830f fillcolor=yellow> <v:extrusion on=t backdepth=15pt color="#d8a967"/>
<v:fill type=gradientRadial opacity=.5 color2=white method="any"/>
<v:Textbox style="FONT-SIZE:20;WIDTH:108.062pt;FONT-FAMILY:黑体;LETTER-SPACING:1;HEIGHT:180pt;TEXT-ALIGN:center" inset="0,0,0,0">
<a href=flashvml3/helpflash.htm>入门动画教程</a><BR>
<a href=flashvml3/helptool.htm>入门图解教程</a><BR>
<a href=shili/vmlgirl2_luxiang.htm>实战绘图录像</a><BR>
<a href=shili/fsba.gif>实战 3D 网页</a><BR>
<a href=shili/sjtb.htm onclick='alert("该实例非原创，而是沐缘华收集自网络\n原作者不详，个人认为是采用MS Office制作")'>实战数据图表</a><BR>
<a href=shili/vml2d_1.htm>2D 动画特技1</a><BR>
<a href=shili/vml3d_1.htm>3D 动画特技1</a><BR>
<a href=shili/vml3d_2.htm>3D 动画特技2</a><BR>
<a href=../index.htm???3_1>详细帮助手册</a><BR>
<FONT onclick=helpzou() style='color:blue;cursor:hand'>关闭菜单</FONT> </v:Textbox>
</v:roundrect>

<v:rect id=guanyu style="Z-INDEX:30010;LEFT:238;WIDTH:484;POSITION:absolute;TOP:107;HEIGHT:335;display:none" strokecolor=#f520df strokeweight=1.5pt>
<v:stroke dashstyle="longDashDotDot"/>
</v:rect>
<v:Textbox id=guanyu1 style="OVERFLOW-Y:scroll;FONT-SIZE:12;Z-INDEX:30020;LEFT:247;WIDTH:470;WORD-BREAK:break-all;FONT-FAMILY:宋体;POSITION:absolute;TOP:118;HEIGHT:303;display:none" inset="5pt,5pt,5pt,5pt">
<CENTER style="FONT-SIZE:20;COLOR:red;FONT-FAMILY:黑体">FlashVml(闪耀之星)3.0中文版 - 关于</CENTER>
<BR>FlashVml3.0简介:{ <BR>中文名称:闪耀之星 <BR>多重用途:基于WEB运行的图像设计、3D网页设计、动画设计、VML最强开发工具 <BR>形象代言:WEB上的闪耀之星、VML最强开发工具、WEB上的PhotoShop+Flash <BR>本版授权:免费使用权、源码公开 <BR>最低配置:IE5+或支持VML的浏览器、硬盘&gt;300K、内存&gt;64M、显卡支持DriectX2D\3D <BR>} <BR>原作者/版权所有:{ <BR>Pet name:沐缘华(原名:风云舞)、True name:杨华、Address:山东/China、Age:20 <BR>Sex:young man、Current Occupation:经销商人(1年)、自由程序员(4年) <BR>Excel:HTML/CSS/VML、JS/DHTML/VBS、ASP/ASP.net、VB6、XML/XSL <BR>Work:FlashVml(闪耀之星)、Lshdic(网络程序员伴侣)、LureCoder(诱惑代码) <BR>&nbsp; &nbsp; &nbsp;LanLiBBS(蓝丽技术论坛)、风色彼岸、…………  <BR>QQ:21152530 MSN:lshdic@sina.com Mail1:lshdic@sina.com Mail1:fywz2@163.com <BR>Photo:<FONT style="CURSOR:hand;COLOR:blue" onclick='mephoto.style.display=="none"?mephoto.style.display="":mephoto.style.display="none"'>click me for show</FONT> <BR>
<IMG id=mephoto style=display:none src="flashvml/shili/fyw1.jpg"><br>DateTime:2005-2-10 22:02:32 <BR>} <BR>更多消息(内适时更新、完整全面、包括最新版以及幕后支持人员名单){ <BR>
<A id=fuwuqi1 href="http://lydsgw.com/fyw/fvmlmessage.asp" target="guanyuframe">http://lydsgw.com/fyw/</A>(好友freeta提供,默认服务器) <BR>
<IFRAME marginheight=0 marginwidth=0 frameborder=0 id=guanyuframe name=guanyuframe width=96% height=600>
</IFRAME>
<BR>}</v:Textbox>
<v:Textbox id=guanyu2 style="FONT-SIZE:13;Z-INDEX:30030;LEFT:453;WIDTH:115;CURSOR:hand;COLOR:blue;WORD-BREAK:break-all;FONT-FAMILY:宋体;POSITION:absolute;TOP:425;HEIGHT:8;display:none" inset="0,0,0,0" onmousedown=guanyuguan()>Close(关闭该窗口)</v:Textbox>

<script>

var huaban_yanse="#EEEEEE",huaban_biaoti="吾之画",huaban_zuidahua=true,huaban_gundongtiao=0
var huaban_gundongbase="purple",huaban_tianjiaid=true,huaban_pingbicuowu=true
var huaban_cookies=1,huaban_wangge="50px",huaban_wanggese="#5fb6f6",huaban_huanying=true
var huaban_scroll=true,huaban_tishi=true,huaban_juzhenwid=450,huaban_juzhenhei=260
var huaban_juzhencolor="black",huaban_juzhen=true
var meinvtime=null,nonos="none"
jiazai("界面设定程序")
function meinvgo(){ 
meinv.style.display="";
meinvtext2="meinvtime=setInterval('if(meinv.offsetTop>-400){meinv.style.top=meinv.offsetTop-15}else{clearInterval(meinvtime);meinv.style.display=nonos;changsts();}',30)"
meinvtime=setInterval("if(meinv.offsetTop>0){meinv.style.top=meinv.offsetTop-15}else{clearInterval(meinvtime);mmtishi.style.display='';setTimeout(\"mmtishi.style.display=nonos;"+meinvtext2+"\",2000)}",30)
}
var helptime=null
function helplai(){
if(helptime!=null){
clearInterval(helptime);helptime=null
};
if(helptool.style.display!='none'){helpzou();return false}
helptool.style.top=-280;helptool.style.display=''
helptime=setInterval("if(helptool.offsetTop<130){helptool.style.top=parseInt(helptool.style.top)+15}else{clearInterval(helptime);helptime=null}",30)
}
function helpzou(){
if(helptime!=null)return false
helptime=setInterval("if(helptool.offsetTop>-280){helptool.style.top=parseInt(helptool.style.top)-20}else{clearInterval(helptime);helptime=null;helptool.style.display='none'}",30)
}
var guanyutime=null,guanyuone=0
function guanyukai(){ 
showdiv.style.display="none"
if(guanyutime!=null||guanyu.style.display==''){clearInterval(guanyutime);guanyutime=null;guanyuguan();return false}
guanyu.style.width=0;guanyu.style.left=bodyscrollleft+document.body.offsetWidth/2;guanyu.style.display='';guanyu1.style.display='none';guanyu2.style.display='none'
guanyutime=setInterval("if(parseInt(guanyu.style.width)<484){guanyu.style.left=parseInt(guanyu.style.left)-5;guanyu.style.width=parseInt(guanyu.style.width)+10}else{clearInterval(guanyutime);guanyutime=null;guanyu1.style.left=parseInt(guanyu.style.left)+10;guanyu2.style.left=(guanyu.offsetLeft+(guanyu.offsetWidth/2))-(parseInt(guanyu2.style.width)/2);guanyu1.style.display='';guanyu2.style.display='';if(guanyuone==0){guanyuframe.location.href=fuwuqi1.href;guanyuone=1}}",30)
}
function guanyuguan(){ 
if(guanyutime!=null){return false}
guanyu1.style.display='none';guanyu2.style.display='none'
guanyutime=setInterval("if(parseInt(guanyu.style.width)>20){guanyu.style.left=parseInt(guanyu.style.left)+10;guanyu.style.width=parseInt(guanyu.style.width)-20}else{clearInterval(guanyutime);guanyutime=null;guanyu.style.display='none'}",30)
}
function deletecookies(){  
var dates = new Date();
dates.setDate(dates.getDate()-1000);
document.cookie="fvml1=1;expires="+dates.toGMTString() 
}
function setcookies(){  
var dates=new Date() 
dates.setDate(dates.getDate()+365)
document.cookie="fvml1="+huabutab.width+","+huaban_yanse+","+huaban_gundongbase+","+huaban_biaoti+","+huaban_zuidahua+","+huaban_gundongtiao+","+yesaddnextid.checked+","+pingbicuowu.checked+","+xunhuan1.checked+","+huaban_cookies+","+huaban_wangge+","+huaban_wanggese+","+huaban_huanying+","+huaban_scroll+","+huaban_tishi+","+huaban_juzhenwid+","+huaban_juzhenhei+","+huaban_juzhencolor+","+huaban_juzhen+";expires="+dates.toGMTString() 
}
function getcookies(){  
if(document.cookie=="")return false;
cookies=document.cookie.split('; ')
temp1=-1
for(i=0;i<cookies.length;i++){if(cookies[i].indexOf("fvml1=")==0)temp1=i} 
if(temp1==-1)return false
cks=cookies[temp1].substr(6).split(",") 
if(cks.length!=19){ 
alert("FlashVml3.0自动更新、纠错成功:\n\n检测您上次的画板设置有错误，这可能是你使用了FVML3.0之前的版本\n或者是你在[画板设置]中故意输入了错误的数据造成\n\n不过FlashVml已清除掉这些错误数据，自动纠正并启用软件默认值\n以后该提示将不会出现、软件自动更新、纠错成功！");deletecookies();return false
}
huaban_cookies=cks[9]
if(huaban_cookies==0){deletecookies();return false} 
huabutab.width=cks[0];huabutab.height=cks[0] 
div1.style.backgroundColor=cks[1];huaban_yanse=cks[1]
document.body.style.scrollbarBaseColor=cks[2];huaban_gundongbase=cks[2]
huaban_biaoti=cks[3]
if(cks[4]=="false")huaban_zuidahua=false
huaban_gundongtiao=cks[5]
if(cks[6]=="false")yesaddnextid.checked=false
if(cks[7]=="false")pingbicuowu.checked=false
if(cks[8]=="false")xunhuan1.checked=false
if(cks[12]=="false")huaban_huanying=false
if(cks[13]=="false")huaban_scroll=false
if(cks[14]=="false")huaban_tishi=false
huaban_juzhenwid=cks[15];huaban_juzhenhei=cks[16];huaban_juzhencolor=cks[17];
if(cks[18]=="false")huaban_juzhen=false
huaban_wangge=cks[10];huaban_wanggese=cks[11];
}
var muqianwangge=false  
function wangge(){ 
if(muqianwangge==false){
muqianwangge=true
temp0=huaban_wangge.replace(/px/g,'');temp1=screen.height/temp0;temp2=screen.width/temp0;
temp3=div1.offsetWidth;temp4=div1.offsetHeight;temp5=huaban_wanggese
tempck=" onmouseover=this.style.cursor=div1.style.cursor; onmousedown=div1.onmousedown() onmousemove=div1.onmousemove()";str1=""
for(i=0;i<temp1;i++){str1+="<v:line to="+temp3+",0 style='position:absolute;z-index:5;left:0;top:"+(temp0*i)+";' strokecolor='"+temp5+"' "+tempck+" id='wanggexian'/>"}
for(i=0;i<temp2;i++){str1+="<v:line to=0,"+temp4+" style='position:absolute;z-index:5;left:"+(temp0*i)+";top:0;' strokecolor='"+temp5+"' "+tempck+" id='wanggexian'/>"}
document.body.insertAdjacentHTML("beforeEnd",str1)
}else{muqianwangge=false;templen=wanggexian.length;for(i=0;i<templen;i++){wanggexian[i].removeNode();templen--;i--}}
}
var muqianfjx=false
function fenjiexian(){ 
if(muqianfjx==false){
muqianfjx=true;str1="";tempcolor="green";
var temparrayx=new Array(640,800,1024,1152,1280),temparrayy=new Array(480,600,768,864,960)
for(i=0;i<temparrayx.length;i++){
tempck=" onmousedown=alert('当前分界线:"+temparrayx[i]+"*"+temparrayy[i]+"')";
str1+="<v:line to="+temparrayx[i]+",0 style='position:absolute;z-index:6;left:0;top:"+temparrayy[i]+";cursor:help' strokecolor='"+tempcolor+"'"+tempck+" id='fjx'/>"
str1+="<v:line to=0,"+temparrayy[i]+" style='position:absolute;z-index:6;left:"+temparrayx[i]+";top:0;cursor:help' strokecolor='"+tempcolor+"'"+tempck+" id='fjx'/>"
}
document.body.insertAdjacentHTML("beforeEnd",str1)
}else{
templen=fjx.length;for(i=0;i<templen;i++){fjx[i].removeNode();templen--;i--}
muqianfjx=false
}}
function juzhenmove(){ 
juzhen1.style.width=huaban_juzhenwid;juzhen1.style.height=huaban_juzhenhei;juzhen1.strokecolor=huaban_juzhencolor;
juzhen1.style.left=(bodyscrollleft+(document.body.offsetWidth/2))-(huaban_juzhenwid/2)
juzhen1.style.top=(bodyscrolltop+(document.body.offsetHeight/2))-(huaban_juzhenhei/2)
}
function juzhen(){ 
if(juzhen1.style.display==''){
juzhen1.style.display='none'
}else{
juzhenmove();juzhen1.style.display=''
}}
function window.onload(){  
getcookies();
if(huaban_huanying!=false){  
window.status="FlashVml3.0("+filesize1+"字节) -- 全部加载完毕,开场欢迎程序始运行,欢迎使用FlashVml!"
meinvgo()
}else{changsts()}
if(huaban_juzhen==true)juzhen()
setInterval('worktime++;changsts()',60000) 
}
function window.onbeforeunload(){  
setcookies()
}
keystrs="; flashvml; 闪耀之星; vml; VML; vmlflash; vml动画; 矢量; 2D; 3D; 沐缘华; FYW; 画板; 在线画图"
var flashvmlfunadd="",flashvml2funadd="",statuschangefunadd="" 
var xx=0,yy=0,moveok=0
var onloadjiaobenstr="" 
function onloadstr(whatonload){
if(whatonload==true){jtempp="\n"+flashvmlfunadd+flashvml2funadd+statuschangefunadd}else{jtempp=""}
if(onloadjiaobenstr!=""){jtempp2="\n"+onloadjiaobenstr+"\n"}else{jtempp2=""}
return "<script>\n//启动更新函数,更新所有使用隐藏功能的物件初期视图\nvar loadtime=null,loadtext='if(document.readyState!=\"complete\"){window.status=window.status+\".\"}else{clearInterval(loadtime);window.status=\"\"}';\nwindow.status='相关图形\程序\图像\音乐正在加载，请等待'\nloadtime=setInterval(loadtext,200)\nfunction window.onload(){"+jtempp+jtempp2+"}\n;;;/script>"
}
</script>
<textarea id=loadendscript style=display:none>
<SCRIPT>  //以下程序快速执行使预隐藏图形及时隐藏
try{var bodyobjs=document.body.children;for(i=0;i<bodyobjs.length;i++){if(bodyobjs[i].yincang!=null)bodyobjs[i].style.display='none';}}catch(e){}
</SCRIPT>
</BODY>
</HTML>
</textarea>
<textarea id=dhfun_dizhen style=display:none>
var windowtime=null,dzbuzhou=1
function windowdizhen(wzhenfu){  //流线动画使用窗口地震效果必要函数
if(windowtime!=null){clearTimeout(windowtime);windowtime=null}
if(window.cccx==null){window.cccx=window.screenLeft;window.cccy=window.screenTop}
wzhenfu2=Math.round(Math.random()*wzhenfu)
Math.random()>0.5?windowBy=wzhenfu2:windowBy=-wzhenfu2;
if(dzbuzhou==1){eval("window.moveBy("+windowBy+",0)")}
else if(dzbuzhou==2){eval("window.moveBy(0,"+windowBy+")")}
else if(dzbuzhou==3){window.moveTo(window.cccx+","+window.screenTop)}
else if(dzbuzhou==4){window.moveTo(window.cccx+","+window.cccy)}
dzbuzhou++;if(dzbuzhou==5)dzbuzhou=1
document.title=window.cccx
windowtime=setTimeout("window.moveTo(parseInt(window.cccx)+','+parseInt(window.cccy));clearTimeout(windowtime);windowtime=null",500)
}
var dizhentime=new Array()
function dizhen(dzobj,zhenfu){  //流线动画使用图形地震效果必要函数
thesoudex=dzobj.sourceIndex
if(dzobj.dizhen==null){
dizhentime[thesoudex]=null
dzobj.oldleft=dzobj.style.left;dzobj.oldtop=dzobj.style.top;dzobj.dzbuzhou=1;dzobj.dizhen=true
}
if(dizhentime[thesoudex]!=null){clearTimeout(dizhentime[thesoudex]);dizhentime[thesoudex]=null}
tempx=parseInt(dzobj.style.left);tempy=parseInt(dzobj.style.top);
zhenfu2=Math.round(Math.random()*zhenfu)
Math.random()>0.5?zhengui2="+":zhengui2="-";
if(dzobj.dzbuzhou==1){eval("dzobj.style.left=tempx"+zhengui2+"zhenfu2")}
else if(dzobj.dzbuzhou==2){eval("dzobj.style.top=tempy"+zhengui2+"zhenfu2")}
else if(dzobj.dzbuzhou==3){dzobj.style.left=dzobj.oldleft}
else if(dzobj.dzbuzhou==4){dzobj.style.top=dzobj.oldtop}
dzobj.dzbuzhou++;if(dzobj.dzbuzhou==5)dzobj.dzbuzhou=1
dizhentime[thesoudex]=setTimeout(dzobj.id+".style.left="+dzobj.id+".oldleft;"+dzobj.id+".style.top="+dzobj.id+".oldtop;clearTimeout(dizhentime[thesoudex]);dizhentime[thesoudex]=null",500)
}
 //使用动态裁剪效果必要函数
function clipcool(clipobj,clipsudu,cliptopyes,cliprightyes,clipdownyes,clipleftyes){
if(clipobj.caijian==null){
clipobj.objwid=clipobj.offsetWidth;clipobj.objhei=clipobj.offsetHeight;
clipobj.style.clip="rect(0 "+clipobj.objwid+" "+clipobj.objhei+" 0)"
clipobj.cliptop=0;clipobj.clipright=clipobj.objwid;clipobj.clipdown=clipobj.objhei;clipobj.clipleft=0
clipobj.caijian=true
}
if(cliprightyes==true)clipobj.objwid-=clipsudu
if(clipdownyes==true)clipobj.objhei-=clipsudu
if(cliptopyes==true)clipobj.cliptop+=clipsudu
if(clipleftyes==true)clipobj.clipleft+=clipsudu
clipobj.style.clip="rect("+clipobj.cliptop+"px "+clipobj.objwid+"px "+clipobj.objhei+"px "+clipobj.clipleft+"px)"
}
 //使用3D旋转必要函数
function addliti(objname1,objusex,objusey,objuseposx,objuseposy){
if(objname1.liti==null){objname1.extrusion.on=true;if(objname1.extrusion.backdepth==36)objname1.extrusion.backdepth='10px';
objname1.litix=0;objname1.litiy=0;objname1.liti=true}
if(objusex==true)objname1.litix+=objuseposx;
if(objusey==true)objname1.litiy+=objuseposy;
objname1.extrusion.rotationangle=objname1.litix+","+objname1.litiy
}
</textarea>

<script>jiazai("可视化设计工具")</script>
<v:rect id=juzhen1 style="Z-INDEX:10;POSITION:absolute;display:none;cursor:help" filled=f strokecolor=red strokeweight=1px onmousedown="alert('矩阵当前大小:x'+parseInt(this.style.width)+',y'+parseInt(this.style.height))"/>  
<v:line style="position:absolute;z-index:50000;display:none;top:0" id=biaochi1 to=0,10pt strokecolor=blue strokeweight=5pt>  
<v:stroke endarrow="classic"/>
</v:line>
<v:line style="position:absolute;z-index:50000;display:none;left:0" id=biaochi2 to=10pt,0 strokecolor=blue strokeweight=5pt>  
<v:stroke endarrow="classic"/>
</v:line>
<v:rect class=keshi style=display:none;z-index:50000 stroked=f fillcolor=lime id=biaoshi onmouseup='this.style.display="none"'>  
<v:fill opacity="0.3"/>
</v:rect>
<v:Line class=keshi style=display:none id=line1 dashstyle=dashdot>  
<v:Stroke dashstyle="dashdot"/>
</v:line>
<v:arc startangle=360 endangle=30 class=keshi style=display:none id=arc1>  
<v:Stroke dashstyle="dashdot"/>
</v:arc>
<v:Oval class=keshi style=display:none id=oval1>  
<v:Stroke dashstyle="dashdot"/>
</v:oval>
<v:rect class=keshi style=display:none id=rect1>  
<v:Stroke dashstyle="dashdot"/>
</v:rect>
<v:rect class=keshi style="display:none;cursor:hand" fillcolor=yellow strokecolor=red strokeweight=1px id=caijian onmouseup="if(event.button==1){var skk=prompt('请输入一个步长(默认为25)，然后请使用方向键[上、下、左、右]控制进行裁剪，裁剪完成后，按下[回车键]或[鼠标右键]完成。注意必须输入数字，否则无法裁剪。建议输入范围5-50',caijianbu);if(skk!=''&&skk!=null){caijianbu=parseInt(skk);}}else{caijian.style.display='none';thisobj=null;return false}">  
<v:Stroke dashstyle='dashdot'/>
<v:fill opacity="0.1"/>
</v:rect>
<v:roundrect arcsize=.1 class=keshi style=display:none id=roundrect1>  
<v:Stroke dashstyle='dashdot'/>
</v:roundrect>
<table cellspacing=0 cellpadding=0 width=200% height=200% id=huabutab><tr><td>   
<div style='width:100%;height:100%;background-color:eeeeee;color:black;cursor:crosshair;' id=div1></div>
</td></tr></table>
<span class=keshi style="display:none;left:expression(bodyscrollleft+document.body.offsetWidth/2-(this.offsetWidth/2));top:expression(bodyscrolltop+document.body.offsetHeight/2-(this.offsetHeight/2));z-index:40000;display:none;background-color:#FCDCF1;width:335" id=huabanshezhi>   
<FIELDSET style="width:100%;padding:5;">
<Legend>画板状态设置</legend>
视图大小:<select id=huaban_daxiao1 style=width:50><option>最小<option selected>二倍<option>三倍<option>四倍<option>五倍</select> 滚动条色:<input style='border:1 solid black;width:50;height:17;' value='purple' onmousedown='rndcolor(this.id)' id='huaban_gundongbase1'><br>网格像素:<select id=huaban_wangge1 style=width:50><option>25px<option selected>50px<option>75px<option>100px<option>125px<option>150px<option>175px<option>200px</select> 网格颜色:<input style='border:1 solid black;width:50;height:17;' value='#5fb6f6' onmousedown='rndcolor(this.id)' id='huaban_wanggese1'><br>
矩阵宽度:<input maxlength=4 style='border:1 solid black;width:50;height:17;' id=huaban_juzhenwid1> 矩阵高度:<input maxlength=4 style='border:1 solid black;width:50;height:17;' id=huaban_juzhenhei1> 矩阵颜色:<input style='border:1 solid black;width:50;height:17;' value='red' onmousedown='rndcolor(this.id)' id='huaban_juzhencolor1'><br>
作业背景:<input style='border:1 solid black;width:50;height:17;' value='#EEEEEE' onmousedown='rndcolor(this.id)' id='huaban_yanse1'> 作业标题:<input style='border:1 solid black;width:160;height:17;' value='吾之画' id=huaban_biaoti1><br>
设计工具跟随滚动条:<input type=checkbox checked id=huaban_scroll1> 允许按钮出现动态帮助提示:<input type=checkbox checked id=huaban_tishi1>
</FIELDSET><br>
<FIELDSET style="width:100%;padding:5">
<Legend>运行状态设置</legend>
显示画板类似滚动条:<input type=radio checked name=huaban_gundongtiao1> 自动最大化窗口:<input type=checkbox checked id=huaban_zuidahua1><br>
显示系统默认滚动条:<input type=radio name=huaban_gundongtiao1><br>
不显示任何的滚动条:<input type=radio name=huaban_gundongtiao1>
</FIELDSET><br>
<FIELDSET style="width:100%;padding:5">
<Legend>画板下次启动时自动设置(Cookies)</legend>
VMLGirl开场欢迎:<input type=checkbox checked id=huaban_huanying1> 显示矩阵:<input type=checkbox checked id=huaban_juzhen1><br>
<font id=xiaolei>应用画板的默认设置:</font><input type=radio name=huaban_cookies1> <font id=xiaolei>应用本次对画板设置的改动:</font><input type=radio checked name=huaban_cookies1><br>
</FIELDSET><br><Center>
<input type=button value='确定' class=bon3 onclick="huaban_gundongbase=huaban_gundongbase1.value;huaban_yanse=huaban_yanse1.value;huaban_biaoti=huaban_biaoti1.value;huaban_zuidahua=huaban_zuidahua1.checked;for(i=0;i<huaban_gundongtiao1.length;i++){if(huaban_gundongtiao1[i].checked)huaban_gundongtiao=i};div1.style.backgroundColor=huaban_yanse;huabutab.width=(100*huaban_daxiao1.selectedIndex)+100+'%';huabutab.height=(100*huaban_daxiao1.selectedIndex)+100+'%';for(i=0;i<huaban_cookies1.length;i++){if(huaban_cookies1[i].checked)huaban_cookies=i};huabanshezhi.style.display='none';document.body.style.scrollbarBaseColor=huaban_gundongbase;huaban_wangge=huaban_wangge1.options[huaban_wangge1.selectedIndex].text;huaban_wanggese=huaban_wanggese1.value;huaban_huanying=huaban_huanying1.checked;huaban_scroll=huaban_scroll1.checked;huaban_tishi=huaban_tishi1.checked;huaban_juzhenwid=huaban_juzhenwid1.value;huaban_juzhenhei=huaban_juzhenhei1.value;huaban_juzhencolor=huaban_juzhencolor1.value;huaban_juzhen=huaban_juzhen1.checked;changsts();juzhenmove()" style=width:50> <input style=width:50 type=button value='默认值' class=bon3 onclick="huaban_daxiao1.options[1].selected=true;huaban_yanse1.value='#EEEEEE';huaban_yanse1.style.color='#EEEEEE';huaban_gundongbase1.value='purple';huaban_gundongbase1.style.color='purple';huaban_biaoti1.value='吾之画';huaban_wanggese1.value='#5fb6f6';huaban_wanggese1.style.color='#5fb6f6';huaban_zuidahua1.checked=true;huaban_gundongtiao1[0].checked=true;huaban_cookies1[1].checked=true;huaban_wangge1[1].selected=true;huaban_huanying1.checked=true;huaban_scroll1.checked=true;huaban_tishi1.checked=true;huaban_juzhenwid1.value=450;huaban_juzhenhei1.value=260;huaban_juzhencolor1.value='black';huaban_juzhen1.checked=true"> <input style=width:50 type=button value='取消' class=bon3 onclick="huabanshezhi.style.display='none'"></center></span>
<iframe id=web src="about:blank" style=display:none></iframe>  
<span class=keshi style="display:none;" id=wenzi1>   
文字内容(支持HTML标签):<select id=textstyle><option value='<b></b>'>粗体字<option value='<i></i>'>斜体字<option value='<u></u>'>下划线<option value='<big></big>'>偏大<option value='<small></small>'>偏小<option value='<sup></sup>'>偏上<option value='<sub></sub>'>偏下<option value='<center></center>'>居中对齐<option value='<font color="#FF0000"></font>'>有字色<option value='<font style="background-color:#FF0000"></font>'>背景色流动字幕</select><input type=button class=bon3 value=加入该标签 onclick='ccc=textstyle.options[textstyle.selectedIndex].value;txt1.focus();document.selection.createRange().text=ccc.substr(0,ccc.indexOf(">")+1)+document.selection.createRange().text+ccc.substr(ccc.indexOf(">")+1)' style=width:75><br>
<textarea id=txt1 style='overflow-y:hidden;width:330;height:100;background-color:Transparent;'></textarea><br>
<center><select style=width:100 id=wenziziti onchange='txt1.style.fontFamily=this.options[this.selectedIndex].text;'>
<script>
var zitistr="<option>默认字体<option>宋体<option>黑体<option>隶书<option>幼圆<option>楷体_GB2312<option>仿宋_GB2312<option>华文中宋<option>华文行楷<option>华文新魏<option>华文细黑<option>华文彩云<option>方正姚体<option>方正舒体<option>Wingdings<option>Wingdings 2<option>Wingdings 3<option>Webdings<option>System<option>@宋体<option>@黑体<option>@隶书<option>@幼圆<option>@楷体_GB2312<option>@仿宋_GB2312<option>@华文中宋<option>@华文行楷<option>@华文新魏<option>@华文细黑<option>@华文彩云<option>@方正姚体<option>@方正舒体<option>@System";
document.write(zitistr)
</script></select> 有无边框<input type=checkbox id=wenzibiankuang checked onclick="this.checked?txt1.style.borderWidth=1:txt1.style.borderWidth=0"> 有滚动条<input type=checkbox id='wenzigundongtiao' onclick="this.checked?txt1.style.overflowY='scroll':txt1.style.overflowY='hidden'"> 背景透明<input type=checkbox id=beijingtouming checked onclick="this.checked?txt1.style.backgroundColor='Transparent':txt1.style.backgroundColor=wenzibeijing.value"><br>
颜色:<input style='border:1 solid black;width:50;height:17;' value='#000000' onmousedown='rndcolor(this.id)' id=wenziyanse onmousemove='txt1.style.color=this.value;'> 背景:<input style='border:1 solid black;width:50;height:17;' value='#FFFFFF' onmousedown='rndcolor(this.id)' id=wenzibeijing onmousemove='if(!beijingtouming.checked)txt1.style.backgroundColor=this.value'> 大小:<select style=width:50 id=wenzidaxiao onchange='txt1.style.fontSize=this.options[this.selectedIndex].text;'><script>var temp101="";for(i=1;i<101;i++){temp101+="<option>"+i;}document.write(temp101);wenzidaxiao.options[11].selected=true</script></select><br>
<select id=duiqi onchange="if(this.options[0].selected==true)txt1.style.textAlign='left';if(this.options[1].selected==true)txt1.style.textAlign='center';if(this.options[2].selected==true)txt1.style.textAlign='right';"><option value=''>左对齐<option value='center'>居中<option value='right'>右对齐</select><Select id=zijiange onchange="if(this.options[0].selected==false)txt1.style.letterSpacing=this.options[this.selectedIndex].text;else txt1.style.letterSpacing=''"><option>默认字间隔度<Script>document.write(temp101)</script></select><Select id=hangjiange onchange="if(this.options[0].selected==false)txt1.style.lineHeight=this.options[this.selectedIndex].text;else txt1.style.lineHeight=''"><option>默认行隔度<Script>var temp1="";for(i=1;i<10;i+=0.5){temp1=temp1+"<option>"+i.toPrecision(2)}document.write(temp1)</script></select><br>
<input type=button value='插入' class=bon3 onclick="charuwenzi()" id=charu1><input type=button value='取消' class=bon3 onclick="wenzi1.style.display='none'">
</span>
<span class=keshi style="display:none;text-align:left" id=tupian1>   
<v:image src=xxx.jpg id=tempimg style='width:100;height:100;'/><br>
<input type=file id=file1 style=width:350 onchange="tempimg.src=document.all('file1').value"><br>
<input type=button value=插入 class=bon3 onclick="charutupian()"><input type=button value='取消' class=bon3 onclick="tupian1.style.display='none'"> 支持http://,file:///协议
</span>
<span class=keshi style=display:none id=beijingtupian1>   
请输入背景图像的来源HTTP地址，或浏览使用本机图片<br>
<input type=file id=file2 style=width:350><br>
融合普通背景<input type=checkbox id=ronghebeijing checked> 图像拉伸<input type=radio name=beijinglashen checked> 图像平铺<input type=radio name=beijinglashen>
<br><input type=button value='增加' class=bon3 onclick="charubeijingtupian()"><input type=button value='取消' class=bon3 onclick="beijingtupian1.style.display='none'"><input type=button value='卸载目标背景图像' class=bon3 onclick="if(gaojiobj.fill.src!=''){gaojiobj.fill.src='none';}else{alert('目标没有背景图像，无需卸载')}beijingtupian1.style.display='none'" style=width:120>
</span>

<span class=keshi style="display:none;text-align:left;" id=gaoji1>   
<table width=350 cellspacing=0 cellpadding=0 style='background-color:Transparent;'><tr valign=top><td width=130>
宽度(Width) <input maxlength=4 id=objcss style='border:1 solid black;width:40;height:17;'>PX<br>
高度(Height)<input maxlength=4 id=objcss style='border:1 solid black;width:40;height:17;'>PX<br>
三维(ZIndex)<input maxlength=5 id=objcss style='border:1 solid black;width:40;height:17;'>ZX<br>
位置左(Left)<input maxlength=4 id=objcss style='border:1 solid black;width:40;height:17;'>PX<br>
位置上(Top) <input maxlength=4 id=objcss style='border:1 solid black;width:40;height:17;'>PX
</td><td width=220>
TagName:<font color="red"><B id=tagnametext></b></font>,已隐藏:<font color="red"><B id=yiyincang>否</b></font><br>
允许被打印机打印<input type=checkbox checked id=printok><br>
提示标题(Title):<select id=shubiaozhuangtai><option value="">默认鼠标形状<option value=hand>点击状态<option value=crosshair>十字状态<option value=move>拖动状态<option value=help>帮助状态<option value=wait>漏斗状态<option value=text>输入状态<option value=n-resize>n-resize<option value=e-resize>e-resize<option value=s-resize>s-resize<option value=w-resize>w-resize<option value=ne-resize>ne-resize<option value=nw-resize>nw-resize<option value=se-resize>se-resize<option value=sw-resize>sw-resize</select><br><textarea rows=2 style='width:100%;height:38' id=tishibiaoti></textarea>
</td></tr></table>
<textarea id=txt2 style='width:350;height:110'></textarea><br>
<center><input type=button value='修改' class=bon3 onclick="for(i=0;i<objcss.length;i++){if(isNaN(objcss[i].value)){alert('数据['+objcss[i].value+']格式必须为数字');return false}};gaojiobj.outerHTML=txt2.value.replace(/ onmouse/g,' temp_onmouse').replace(/ onkey/g,' temp_onkey').replace(/ (onclick|ondblclick)/g,' temp_$1');var tempobjs1=document.all[gaojiobjdex];tempobjs1.style.cursor=shubiaozhuangtai.value;if((tishibiaoti.value==''&&tempobjs1.title!='')||(tishibiaoti.value!=''&&tempobjs1.title=='')||(tishibiaoti.value!=''&&tempobjs1.title!=''))tempobjs1.title=tishibiaoti.value;try{tempobjs1.style.width=objcss[0].value;tempobjs1.style.height=objcss[1].value;tempobjs1.style.zIndex=objcss[2].value;tempobjs1.style.left=objcss[3].value;tempobjs1.style.top=objcss[4].value;if(!printok.checked)tempobjs1.print=false;if(printok.checked&&tempobjs1.print==false)tempobjs1.print=true}catch(e){alert('Width/Height/zIndex/Left/Top数据格式必须为数字')};gaojiobj=null;gaoji1.style.display='none';getallid()"><input type=button class=bon3 value=取消 onclick='gaoji1.style.display="none"'> <b>共<font id=zishu2 color=red>0</font>字</b>
</span>

<span class=keshi style="display:none;text-align:left" id=shijian1>   
程序辅助输入工具:<input type=button class=bon3 value=文件路径 onclick="thefile1.click();if(document.all.thefile1.value!='')shijiantxt.value+='file:///'+document.all.thefile1.value.replace(/\\/g,'/')" style=width:70><input type='file' id=thefile1 style=display:none> <input style='border:1 solid black;width:54;height:20;' value='颜色代码' id=yansedaima onmousedown='rndcolor(this.id)'><br>
<textarea id=shijiantxt style='width:300;height:100'></textarea><br>
<div id=chengxu1>图形控制:<select id=jianyichengxu style=width:170>
<Optgroup label='外观控制类-基本通用' style='color:green;'><Option value="strokeweight='5'">边框粗度改变<Option value="strokecolor='#FF0000'">边框颜色改变<Option value="stroked='false'">隐藏边框<Option value="stroked='true'">显示边框<Option value="fillcolor='#FF0000'">背景颜色改变<Option value="filled='f'">背景空心<Option value="filled='t'">取消背景空心<Option value="Rotation='80'">旋转角度设定<Option value="shadow.color='black';%%%.shadow.offset='3pt,3pt';%%%.shadow.on='t'">增加阴影效果<Option value="shadow.on='f'">取消阴影效果<Option value="extrusion.on='t';%%%.extrusion.foredepth='0';%%%.extrusion.backdepth='20pt';%%%.extrusion.color='#FFFFFF';%%%.extrusion.rotationangle='0,0'">增加立体效果<Option value="extrusion.on='f'">取消立体效果<Option value="fill.color='blue';%%%.fill.type='gradient'">背景渐变色填充1<Option value="fill.color='blue';%%%.fill.type='gradientradial'">背景渐变色填充2<Option value="fill.type='frame';%%%.fill.src='图像地址'">背景图像改变<Option value="path.textpathok=true;%%%.textPath.fitpath=true;%%%.textPath.on=true;%%%.textPath.string='使用的文字'">边框文字化<Option value="path.textpathok=false;%%%.textPath.on=false">取消边框文字化</Optgroup>
<Optgroup label='Css外观控制类-通用' style='color:blue'><Option value="style.display='none'">隐藏<Option value="style.display=''">取消隐藏<Option value="style.left=300">定位左右位置<Option value="style.top=300">定位上下位置<Option value="style.zIndex=4">定位三维高度<Option value="style.width=300">宽度设定<Option value="style.height=300">高度设定<Option value="style.zoom=1.5">缩放设定<Option value="style.filter='alpha(opacity=50,style=0)'">透明度设定<option value="style.filter='fliph'">左右反转<Option value="style.filter='flipv'">上下反转<Option value="style.clip='rect(0 '+%%%.offsetWidth+' '+%%%.offsetHeight+' 0)'">恢复流线裁剪效果</Optgroup></select><input type=button class=bon3 value=增加该效果 onclick='addxiaoguo(jianyichengxu)' style=width:75><br>
网页控制:<select id=wangyekongzhi style='width:170;color:red'>
<Option value="document.bgColor='#FF0000'">网页背景色改变<Option value="document.body.background='图像路径'">网页背景图改变<option value="document.title='新的网页标题'">网页标题改变<option value="window.status='状态栏文字'">状态栏文字改变<Option value="bgsound1.src='音乐文件地址'">播放音乐文件<option value="window.open('http://www.lshdic.com')">弹出网页窗口<option value="location.href='http://www.lshdic.com'">转到目标网页<option value="location.reload()">刷新本页<option value="location.href='mailto:abc@abc.com'">发送电子邮件<option value="alert('消息内容')">消息对话框<option value="confirm('两种选择')">选择对话框<option value="prompt('请输入密码')">输入对话框<option value="document.body.style.behavior='url(#default#homepage)';document.body.setHomePage(location.href)">设为首页功能<option value="external.AddFavorite(location.href,document.title)">加入收藏夹功能<option value="location.href='view-source:'+location.href">查看源文件功能<option value="opener=null;window.close()">关闭窗口</select><input type=button class=bon3 value=增加该效果 onclick='shijiantxt.focus();document.selection.createRange().text=wangyekongzhi.options[wangyekongzhi.selectedIndex].value+";"' style=width:75><br>
</div>
<div id=chengxu1>
一般效果:<select id=jianyichengxu2 style=width:170><Optgroup label='流线动画专用-逐渐类' style='color:purple'>
<Option value="style.left=parseInt(%%%.style.left)-2">逐渐向左移动<Option value="style.left=parseInt(%%%.style.left)+2">逐渐向右移动<Option value="style.top=parseInt(%%%.style.top)-2">逐渐向上移动<Option value="style.top=parseInt(%%%.style.top)+2">逐渐向下移动<Option value="style.width=parseInt(%%%.style.width)+2">逐渐宽度增加<Option value="style.width=parseInt(%%%.style.width)-2">逐渐宽度减少<Option value="style.height=parseInt(%%%.style.height)+2">逐渐高度增加<Option value="style.height=parseInt(%%%.style.height)-2">逐渐高度减少<Option value="Rotation+=2">逐渐向右旋转<Option value="Rotation-=2">逐渐向左旋转<Option value="strokeweight+=1">逐渐边框粗度增加<Option value="strokeweight-=1">逐渐边框粗度减少<Option value="temp=1;try{%%%.fill.opacity+=0.005}catch(e){}">逐渐背景亮度增加<Option value="temp=1;try{%%%.fill.opacity-=0.005}catch(e){}">逐渐背景亮度减少</Optgroup>
<Optgroup label='流线动画专用-重复类' style='color:maroon'>
<Option value="style.display=='none'?%%%.style.display='':%%%.style.display='none'">重复隐藏/显示图形<Option value="stroked==false?%%%.stroked=true:%%%.stroked=false">重复隐藏/显示边框<Option value="style.zIndex==50000?%%%.style.zIndex=-10000:%%%.style.zIndex=50000">重复覆盖/被物件覆盖<Option value="strokecolor=='red'?%%%.strokecolor='blue':%%%.strokecolor='red'">重复边框颜色交替<Option value="fillcolor=='red'?%%%.fillcolor='blue':%%%.fillcolor='red'">重复背景颜色交替</Optgroup>
<Optgroup label='流线动画专用-随机类' style='color:navy'>
<Option value="strokecolor='rgb('+Math.round(Math.random()*255)+','+Math.round(Math.random()*255)+','+Math.round(Math.random()*255)+')'">边框颜色随机变化<Option value="fillcolor='rgb('+Math.round(Math.random()*255)+','+Math.round(Math.random()*255)+','+Math.round(Math.random()*255)+')'">背景颜色随机变化<Option value="style.left=Math.round(Math.random()*document.body.offsetWidth-100);%%%.style.top=Math.round(Math.random()*document.body.offsetHeight-100)">图形位置随机移动<Option value="style.width=Math.round(Math.random()*300);%%%.style.height=Math.round(Math.random()*300)">图形大小随机改变<Option value="Rotation=Math.round(Math.random()*360)">图形随机旋转</Optgroup>
<Optgroup label='流线动画专用-滤镜类' style='color:#E2028D'>
<Option value="style.filter='alpha(opacity=100,style=0)';%%%.filters[0].opacity-=2">透明度逐渐减少<Option value="style.filter='alpha(opacity=30,style=0)';%%%.filters[0].opacity+=2">透明度逐渐增加
<Option value="style.filter='wave(add=0,freq=4,lightstrength=5,phase=5,strength=0)';%%%.filters[0].strength+=1">波浪效果增强<Option value="style.filter='wave(add=0,freq=4,lightstrength=5,phase=5,strength=80)';%%%.filters[0].strength-=1">波浪效果减弱<Option value="style.filter='blur(add=0,direction=100,strength=0)';%%%.filters[0].strength+=1">模糊效果增强<Option value="style.filter='blur(add=0,direction=100,strength=60)';%%%.filters[0].strength-=1">模糊效果减弱<Option value="style.filter='glow(color=#e8e965,strength=0)';%%%.filters[0].strength+=1">光辉效果增强<Option value="style.filter='glow(color=#e8e965,strength=60)';%%%.filters[0].strength-=1">光辉效果减弱</Optgroup></select><input type=button class=bon3 style=width:75 value=增加该效果 onclick='addxiaoguo(jianyichengxu2)'><br>
动画特技:<select id=jianyichengxu3 style='width:170;color:red'>
<Option value="fill.color='blue';%%%.fill.type='gradient';%%%.fill.angle-=2">背景右向渐变<Option value="fill.color='blue';%%%.fill.type='gradient';%%%.fill.angle+=2">背景左向渐变<Option nodo=true value="dizhen(%%%,10)">图形地震<Option nodo=true value="windowdizhen(20)">引发窗口地震<Option nodo=true value="clipcool(%%%,1,false,true,false,false)">右裁剪<Option nodo=true value="clipcool(%%%,1,false,false,false,true)">左裁剪<Option nodo=true value="clipcool(%%%,1,true,false,false,false)">上裁剪<Option nodo=true value="clipcool(%%%,1,false,false,true,false)">下裁剪<Option nodo=true value="clipcool(%%%,1,false,true,false,true)">左右裁剪<Option nodo=true value="clipcool(%%%,1,true,false,true,false)">上下裁剪<Option nodo=true value="clipcool(%%%,1,true,false,false,true)">左上裁剪<Option nodo=true value="clipcool(%%%,1,false,false,true,true)">左下裁剪<Option nodo=true value="clipcool(%%%,1,true,true,false,false)">右上裁剪<Option nodo=true value="clipcool(%%%,1,false,true,true,false)">右下裁剪<Option nodo=true value="clipcool(%%%,1,true,true,false,true)">左右上裁剪<Option nodo=true value="clipcool(%%%,1,false,true,true,true)">左右下裁剪<Option nodo=true value="clipcool(%%%,1,true,true,true,true)">四边裁剪<Option nodo=true value="addliti(%%%,true,false,1)">3D向上反转<Option nodo=true value="addliti(%%%,true,false,-1)">3D向下反转<Option nodo=true value="addliti(%%%,false,true,null,1)">3D向左反转<Option nodo=true value="addliti(%%%,false,true,null,-1)">3D向右反转<Option nodo=true value="addliti(%%%,true,true,1,2)">3D向左上反转<Option nodo=true value="addliti(%%%,true,true,-1,-2)">3D向右下反转
</select><input type=button class=bon3 style=width:75 value=增加该效果 onclick='addxiaoguo(jianyichengxu3)'><br>
</div>
<center><input type=button value='修改' class=bon3 onclick="shijianfun();shijianobj=null;shijiantxt.value='';"><input type=button class=bon3 value=取消 onclick='shijiantxt.value="";shijian1.style.display="none"'>
<script>
function addxiaoguo(selectobjname){ 
var tempops=selectobjname.options[selectobjname.selectedIndex];shijiantxt.focus();
if(tempops.nodo!=null)yestexts=tempops.value.replace(/%%%/g,objorthis)+";";else yestexts=(objorthis+"."+tempops.value.replace(/%%%/g,objorthis)+";");
document.selection.createRange().text=yestexts;
}
</script>
</span>

<span class=keshi style="display:none;left:expression(bodyscrollleft+document.body.offsetWidth/2-(this.offsetWidth/2));top:expression(bodyscrolltop+document.body.offsetHeight/2-(this.offsetHeight/2));z-index:30000;display:none" id=yuandaima>   
<textarea id=txt3 style='width:500;height:230'></textarea><br>
<textarea readonly id=txt3_top style='width:500;height:110;color:gray'></textarea><br>
<center><b>共<font id=zishu1 color=red>0</font>字，主要代码<font id=zishu1 color=red>0</font>字，头部附加<font id=zishu1 color=red>0</font>字</b>
<input type=button value='复制全部' class=bon3 onclick="window.clipboardData.setData('text',txt3_top.value+txt3.value+loadendscript.value);alert('已将数据复制到系统剪切板')" style=width:60> <input style=width:60 type=button value='更新修改' class=bon3 onclick="div1.innerHTML=txt3.value.replace(/ onmouse/g,' temp_onmouse').replace(/ onkey/g,' temp_onkey').replace(/ (onclick|ondblclick)/g,' temp_$1');yuandaima.style.display='none';getallid()"> <input style=width:60 type=button value='取消' class=bon3 onclick="yuandaima.style.display='none'"> </span>
<span class=keshi style="display:none;text-align:left;" id=jiaoben>   
&lt;script id=myscript language="javascript"&gt;<br>
<textarea id=jiaobentxt style='width:350;height:200'></textarea><br>
function window.onload(){<br>
<textarea id=jiaoben_load style='width:350;height:80'></textarea><br>
}&lt;/script&gt;<br>
<input type=button value='修改' class=bon3 onclick="wodejiaoben=jiaobentxt.value;onloadjiaobenstr=jiaoben_load.value;jiaoben.style.display='none'"> <input type=button value='取消' class=bon3 onclick="jiaoben.style.display='none'">
</span>
<span style='position:absolute;z-index:40000;display:none' id=menu1>    
<input type=button class=bon3 value=置前 onclick='zz+=1;thisobj.style.zIndex=zz;menu1.style.display="none"'><br>
<input type=button class=bon3 value=置后 onclick='zz2-=1;thisobj.style.zIndex=zz2;menu1.style.display="none"'><br>
<input type=button class=bon3 value=复制 onclick='div1.innerHTML+=thisobj.outerHTML;if(div1.lastChild.id!=""){if(eval(div1.lastChild.id).length==2){nextid++;div1.lastChild.id=open_var+nextid}};if(fuzhitixing==false){alert("复制完成，请使用选移功能拖动");fuzhitixing=true};menu1.style.display="none";huabi[bi].className="bon2";huabixuanyi.className="bon1";div1.style.cursor="hand";getallid()' id=fuzhi><br>
<input type=button class=bon3 value=删除 onclick='thisobj.outerHTML="";menu1.style.display="none";getallid()' id=shanchu style='border-bottom:3 solid maroon'><br>
<input type=button class=bon3 value=反转 onclick='var tempn1=thisobj.tagName.toLowerCase();if(tempn1=="textbox"){alert("Textbox文本无法应用");return false};temp1="";if(thisobj.style.flip!=null){temp1=thisobj.style.flip.replace(" ","").toLowerCase();if(temp1.replace("x","").replace("y","")!=""){thisobj.style.flip="x";menu1.style.display="none";return false}}if(temp1=="xy"){thisobj.style.flip="y"};if(temp1=="x"){thisobj.style.flip=""}else if(temp1=="y"){thisobj.style.flip="x y"}else if(temp1==""){thisobj.style.flip="x"};if(tempn1=="curve"){div1.innerHTML=div1.innerHTML;};menu1.style.display="none"'><br>
<input type=button class=bon3 value=颠倒 onclick='var tempn1=thisobj.tagName.toLowerCase();if(tempn1=="textbox"){alert("Textbox文本无法应用");return false};temp1="";if(thisobj.style.flip!=null){temp1=thisobj.style.flip.replace(" ","").toLowerCase();if(temp1.replace("x","").replace("y","")!=""){thisobj.style.flip="x";menu1.style.display="none";return false}}if(temp1=="xy"){thisobj.style.flip="x"};if(temp1=="y"){thisobj.style.flip=""}else if(temp1=="x"){thisobj.style.flip="x y"}else if(temp1==""){thisobj.style.flip="y"};if(tempn1=="curve"){div1.innerHTML=div1.innerHTML;};menu1.style.display="none"'><br>
<input type=button class=bon3 value=裁剪 onclick='if(thisobj.style.clip!=""){if(confirm("这将取消目标现有的裁剪效果然后才可裁剪，你确定么？"))thisobj.style.clip="rect(0 "+thisobj.offsetWidth+" "+thisobj.offsetHeight+" 0)";else return false}caijian.style.left=thisobj.offsetLeft-caijianjuli;caijian.style.top=thisobj.offsetTop-caijianjuli;caijian.style.width=thisobj.offsetWidth+(caijianjuli*2);caijian.style.height=thisobj.offsetHeight+(caijianjuli*2);caijian.style.display="";menu1.style.display="none"' onmousemove='showhelp("裁剪目标图形的上、右、下、左边缘")' style='border-bottom:3 solid maroon'><br>
<input type=button class=bon3 value=取消 onclick='menu1.style.display="none"' style='color:black;font-weight:bold'>
</span>
<span style='position:absolute;z-index:40000;display:none' id=menu2>    
<input type=button class=bon3 value=网格 onclick='wangge();menu2.style.display="none"'><br>
<input type=button class=bon3 value=矩阵 onclick='juzhen();menu2.style.display="none"'><br>
<input type=button class=bon3 value=分界线 onclick='fenjiexian();menu2.style.display="none"'><br>
<input type=button class=bon3 value=刷新 onclick='div1.innerHTML=div1.innerHTML;menu2.style.display="none"' style='border-bottom:3 solid maroon' onmousemove='showhelp("当设计与运行不符时，请使用刷新。")'><br>
<input type=button class=bon3 value=设置 onclick='fvmlshezhi.click();menu2.style.display="none"'><br>
<input type=button class=bon3 value=取消 onclick='menu2.style.display="none"' style='color:black;font-weight:bold'>
</span>

<script>jiazai("编程、动画设计器")</script>
<TABLE cellspacing=0 cellpadding=0 align=center style='position:absolute;left:3;top:20;z-index:2999' onmousedown='if(event.srcElement.tagName=="CENTER"&&event.button==1){moveok=1;setCapture();xx=event.x-this.offsetLeft;yy=event.y-this.offsetTop;}' onmousemove="if(moveok==1){this.style.left=event.x-xx;this.style.top=event.y-yy;}" onmouseup='moveok=0;releaseCapture();if(parseInt(this.style.top)<-10){alert("工具栏高度不能低于页面最顶部");this.style.top=20}if(event.srcElement.tagName=="CENTER"&&event.button==2){this.style.zIndex==2999?this.style.zIndex=6000:this.style.zIndex=2999;}' id=gongjulan3>
<tr><Td style='padding:3;'><center id=cen>编程工具(4) <input type=button class=bon2 value=× style='width:20;height:15' onmousemove='showhelp("关闭不是必要的[编程\\动画]创作工具栏，进行静态绘图作业")' onclick="gongjulan3.style.display='none';xianshigongju.style.display=''"></td></tr>
<Tr><td>
<input type=button class=bon3 value=我的脚本仓库 style=width:105 onmousemove='showhelp("在[我的Script脚本仓库]里，你可以自行编写编程所需的函数、变量<br>以便此后进行事件编程、动画创作时调用")' onclick="jiaoben.style.left=bodyscrollleft+event.x+100;jiaoben.style.top=bodyscrolltop+event.y+30;jiaobentxt.value=wodejiaoben;jiaoben_load.value=onloadjiaobenstr;jiaoben.style.display==''?jiaoben.style.display='none':jiaoben.style.display=''"></td></tr>
<Tr><td><input type=button class=bon3 value=下载LD5 style=width:52 onmousemove='showhelp("下载由作者原创的编程利器《网络程序员伴侣(Lshdic)2005》软件<br>在本地专业的配合FlashVml3.0开发复杂的游戏、动画程序")' onclick="window.open('http://www.google.com/search?hl=zh-CN&q=%E7%BD%91%E7%BB%9C%E7%A8%8B%E5%BA%8F%E5%91%98%E4%BC%B4%E4%BE%A3%28Lshdic%292005&btnG=Google%E6%90%9C%E7%B4%A2&lr=')"><button class=bon2 id=huabi style=width:53 onmousemove='showhelp("查看及修改指定图形用以编程的ID属性")'>定义ID</td></tr>
<Tr><td><label for='yesaddnextid' onmousemove='showhelp("当复选框打勾时，每绘制一个新图形会自动为该图形增加一个顺序ID方便编写程序")' value='绘图时自动添加'>绘图时自动添加</label><input type=checkbox checked id=yesaddnextid></td></tr>
<Tr><td><label for='pingbicuowu' onmousemove='showhelp("当复选框打勾时，会防止你的事件、动画程序在运行出错时弹出错误提示")' value='运行时屏蔽错误'>运行时屏蔽错误</label><input type=checkbox checked id=pingbicuowu></td></tr>
<tr><Td style='padding:3;'><center id=cen>事件编程(5)</td></tr>
<Tr><td><select style=width:70 id=selectshijian onchange='for(i=0;i<huabi.length;i++)if(huabi[i].className!="bon2")huabi[i].className="bon2";huabishijian.className="bon1";div1.style.cursor="hand";'>
<option value=click>左键单击时
<option value=dblclick>双击左键时
<option value=mousedown>鼠标按下时
<option value=mouseup>鼠标弹起时
<option value=mouseover>鼠标靠近时
<option value=mouseout>鼠标离开时
<option value=mousemove>鼠标移动时</select><button name=huabishijian class=bon2 id=huabi style=width:35 onmousemove='showhelp("选择一个事件后，左键单进画布内的图形进行该事件所触发的程序编写")'>增加</td></tr>
<tr><Td style='padding:3;'><center id=cen>动画创作(6)</td></tr>
<Tr><td><select id=allid onmouseover='getallid()' onchange='objorthis=this.options[this.selectedIndex].text;biaoshifun(objorthis);' onmouseup="if(event.button==2&&this.options.length!=1){if(confirm('你想把画板内图形的所有ID标识清除？')){for(i=this.options.length;i>1;i--){eval(this.options[i-1].text).id='';this.remove(i);}}}" style=width:105 size=5><option selected>可用的对象ID</select></td></tr>
<Tr><td><select id=miaozhong style=width:52><option>秒钟<script>tempstr1="";for(i=1;i<301;i++){tempstr1+=("<option>"+i);}document.write(tempstr1)</script></select><select id=pianchang style=width:52 onchange="miaoselchange(this.options[this.selectedIndex].value)"><option>片长<script>tempstr1="";for(i=5;i<65;i+=5){tempstr1+=("<option value="+i+">"+i+"分");}document.write(tempstr1)</script></select></td></tr>
<script>
function miaoselchange(changdulen){ 
if(changdulen=="")return false
shijian1.style.display="none";
changdulen=parseInt(changdulen)
var opstemp1=""
for(i=1;i<60*changdulen+1;i++){
opstemp1+=("<option>"+i)
}
miaozhong.outerHTML="<select id=miaozhong style=width:52><option>秒钟"+opstemp1+"</select>";
for(i=0;i<miaoarray.length;i++){
if(miaoarray[i]!=null){try{miaozhong.options[i].style.backgroundColor="yellow"}catch(e){}}
}
pianchang.options[0].selected=true
}
</script>
<Tr><td align=center><label for=xunhuan1>结束时循环播放</label><input type=checkbox checked id=xunhuan1></td></tr>
<Tr><td><input type=button class=bon3 value=编辑侦动画程序 onmousemove='showhelp("编写侦式动画程序")' onclick="if(miaozhong.selectedIndex==0){alert('编辑动画程序前,必须指定一个[秒钟]');return false}if(allid.selectedIndex==0){alert('编辑动画程序前,必须指定一个[可用的对象ID],可以使用[定义ID标识]功能定义');return false};whodonghua=true;donghuachengxu(allid.options[allid.selectedIndex].text)" style=width:105></td></tr>
<tr><Td style='padding:3;'><center id=cen>流线动画创作(7)</td></tr>
<Tr><td><select id=dianchi1 style=width:105 onchange='dianchi=this.selectedIndex;shijian1.style.display="none";dianchitime1[dianchi]==null?qishimiao.value="":qishimiao.value=dianchitime1[dianchi];dianchitime2[dianchi]==null?haomiaobuchang.value="":haomiaobuchang.value=dianchitime2[dianchi];dianchitime3[dianchi]==null?jieshumiaozhong.value="":jieshumiaozhong.value=dianchitime3[dianchi];'><script>tempstr1="";for(i=1;i<200;i++){tempstr1+=("<option value="+i+">动画蓄电池"+i);}document.write(tempstr1)</script></select></td></tr>
<tr><Td>起始秒钟<input style='border:1 solid black;width:54;height:17;' value=1 id=qishimiao onmousemove='showhelp("支持小数点数字,最小值0.1")'></td></tr>
<tr><Td>毫秒步长<input style='border:1 solid black;width:54;height:17;' value=20 id=haomiaobuchang onmousemove='showhelp("最小值建议为10毫秒速度最快")'></td></tr>
<tr><Td>结束秒钟<input style='border:1 solid black;width:54;height:17;' value=5 id=jieshumiaozhong onmousemove='showhelp("支持小数点数字,最小值0.3")'></td></tr>
<Tr><td><input type=button class=bon3 value=编辑流线动画程序 onmousemove='showhelp("编辑存储于["+dianchi1.options[dianchi1.selectedIndex].text+"]的流线动画程序")' onclick="if(allid.selectedIndex==0){alert('编辑动画程序前,必须指定一个[可用的对象ID],可以使用[定义ID标识]功能定义');return false};str1=qishimiao.value;str2=haomiaobuchang.value;str3=jieshumiaozhong.value;if(str1==''||str2==''||str3==''){alert('起始秒种、毫秒步长、结束秒钟，这些数据必须填写');return false};if(isNaN(str1)||isNaN(str2)||isNaN(str3)){alert('起始秒种、毫秒步长、结束秒钟，这些数据格式必须是数字');return false};if(str1<0.1||str2<1||str3<0.3){alert('起始秒种、毫秒步长、结束秒钟，这些数据不能存在负数，并不能小于其最小限度值');return false};if(parseInt(str1)>parseInt(str3)){alert('起始与结束的概念，被你弄返了');return false};if(str2/1000>=str3-str1){alert('毫秒步长不能大于[结束秒种-起始秒钟]的值');return false};whodonghua=false;donghuachengxu(allid.options[allid.selectedIndex].text)" style=width:105></td></tr>
</td></tr></table>

<script>jiazai("图形画笔、图形处理设计器")</script>
<TABLE cellspacing=0 cellpadding=0 align=center style='position:absolute;left:150;top:1;z-index:3000' onmousedown='if(event.srcElement.tagName=="CENTER"&&event.button==1){moveok=1;setCapture();xx=event.x-this.offsetLeft;yy=event.y-this.offsetTop;}' onmousemove="if(moveok==1){this.style.left=event.x-xx;this.style.top=event.y-yy;}" onmouseup='moveok=0;releaseCapture();if(parseInt(this.style.top)<-10){alert("工具栏高度不能低于页面最顶部");this.style.top=1}if(event.srcElement.tagName=="CENTER"&&event.button==2){this.style.zIndex==3000?this.style.zIndex=6000:this.style.zIndex=3000;}' id=gongjulan1>
<tr><Td style='padding:3;border-right:1 solid gray;'><center id=cen>画笔选择(1) <font onclick="gongjulan3.style.display='';this.style.display='none';" class=zhongyao style="display:none;" id=xianshigongju onmouseover='this.style.color="blue"' onmouseout='this.style.color="red"' onmousemove='showhelp("当您已熟悉FlashVml3.0的静态绘图功能时<br>可以进一步领略FlashVml3.0对程序、动画的设计功能")' value='显示编程\动画工具栏'>显示编程\动画工具栏</font></td><td style='padding:3;border-left:1 solid white;'><center id=cen>图形处理(3) <font onclick="alert('如何下载FlashVml(闪耀之星)3.0:\n\nFlashVml(闪耀之星)简称FVML、当前版本3.0\n如何下载fvml3在本地直接使用？\n你只需将本页另存(文件名.htm)至你的本地硬盘即可(但是不包括演示与帮助文件)\n如想下载完整的fvml3(包括演示与帮助文件)，请登陆skycn.com或google搜索关键字flashvml\n\nFlashVml3.0核心程序简介:\n\n源码构成:Js+Dhtml+(HTML+Css+Vml)、一页源码、另存即用\n授权使用:共享/免费/源码公开\n\nFlashVml3.0常见疑问:\n\nPS:如何保存画板内所绘图像为图像文件(jpg/gif)？\nRE:用截图软件\nPS:是否能将作品源码上传？\nRE:如有固定服务器，作者将制作提供该服务，否则不能\nPS:制做VML动画是不是要会HTML/CSS/VML/JS/DHTML编程？\nRE:一点不会可以用fvml提供的动画效果，创意、编程水准是左右VML深度开发应用的关键\nPS:我已经将源码保存为文件了，怎样在次打开编辑？\nRE:网页上程序操纵你的电脑文件你放心？可使用[查看及修改源码]替代打开文件功能\nPS:画布有必要弄那么大么？还要上、下滚动条？\nRE:画布大是有必要的，如果用fvml设计的是一个800*600或更高的3D网页，那小了就行了？\nPS:我看fvml的界面不喜欢很难看，那么多的按钮眼都花了不知什么用\nRE:作者只是个程序员不是画师，个人设计理念、最大能力是实现{\n   功能一流、操作一流、程序效率近一流、界面朴素/符合逻辑/符合多数人的审美观\n   入门容易、传播容易、充满动感、较多帮助提示、较少非人为漏洞\n   }\nPS:fvml只能在线互联网上用？\nRE:当然不是，你完全可以将fvml做为应用软件般在你电脑当作桌面常用软件使用\nPS:我发现fvml有好多错别字~\nRE:呵呵，程序没错字却错了，而不屑检查，这是很多程序员的通病，请联系作者。')" class=zhongyao onmouseover='this.style.color="blue"' onmouseout='this.style.color="red"'>下载FlashVml3.0</font> <font onclick="helplai()" class=zhongyao onmouseover='this.style.color="blue"' onmouseout='this.style.color="red"'>演示与帮助(F1)</font></td></tr>
<Tr>
<td style='border-right:1 solid gray'><button ps="铅笔" class=bon2 id=huabi onmousemove='showhelp("按住左键写字、划画")'><v:shape style="WIDTH:5px;HEIGHT:5px" coordsize="5,5" filled="f" path=" m0,0 l0,0,10,7,11,7,13,6,17,0,17,-1,17,-2,17,0,17,1,18,4,18,7,19,8,19,9,21,9,24,8,26,7,28,5,29,5,30,5,31,5 33,5,35,5,38,4,41 e" strokeweight='1px'/><button ps="直线" class=bon1 id=huabi onmousemove='showhelp("按住左键移动光标")' style='text-align:left'><v:line from="5pt,3pt" to="30pt,9pt" strokeweight='1px'/><button ps="圆形" class=bon2 id=huabi onmousemove='showhelp("按住左键移动光标")'><v:oval style="WIDTH:20px;HEIGHT:11px" filled='f' strokeweight='1px'/><button ps="长方形" class=bon2 id=huabi onmousemove='showhelp("按住左键移动光标")'><v:rect filled=f style="WIDTH:20px;HEIGHT:11px"  strokeweight='1px'/><button ps="多边形" class=bon2 id=huabi onmousemove='showhelp("以连续点击、移动左键的规律决定每条线的路径，所绘图形为一个整体")'><v:shape filled=f style="WIDTH:5px;HEIGHT:5px" coordsize="5,5" strokeweight='1px' path="m0,0 l0,0,15,-10,30,0,0,0 e"/></button><br>
<button ps="圆矩形" class=bon2 id=huabi onmousemove='showhelp("按住左键移动光标")'><v:roundrect filled=f style="WIDTH:20px;HEIGHT:12px" arcsize="19661f" strokeweight='1px'/><button ps="弧形" class=bon2 id=huabi onmousemove='showhelp("按住左键移动光标即可")'><v:arc filled=f style="WIDTH:26px;HEIGHT:12px" startangle="180" endangle="360" strokeweight='1px'/><button ps="贝塞曲" class=bon2 id=huabi onmousemove='showhelp("(贝塞尔曲线):以连续点击、移动左键的规律决定曲线长度、角度1、角度2")' style='text-align:left'><v:curve from="9pt,4.5pt" control1="35pt,-6pt" control2="-1pt,16pt" to="27pt,4.5pt" filled="f" strokeweight='1px'/><button class=bon2 id=huabi onmousemove='showhelp("单击左键在目标位置插入")' style='color:black' ps=文字>text<button class=bon2 id=huabi onmousemove='showhelp("单击左键在目标位置插入")' style='color:black' ps=图片>image</button>
</td>
<td style='border-left:1 solid white;'><button class=bon2 name=huabixuanyi id=huabi onmousemove='showhelp("按住左键拖动目标图形")'>选移<button class=bon2 name=huabitiaodaxiao id=huabi onmousemove='showhelp("按住左键拖动目标图形")'>调大小<button class=bon2 id=huabi onmousemove='showhelp("左键左右移动旋转目标图形")'>旋转<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形")'>边框<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形，支持背景色填充、背景图片、完全空心化")'>填充<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形")'>阴影</button><br><button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形")'>立体<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形，以文字充当目标图形边框")'>文字化<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形，给图形增加特殊滤镜效果")'>滤镜<button class=bon2 name=huabisuofang id=huabi onmousemove='showhelp("左键点击目标图形")'>缩放<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形（该图形在设计时可见，运行时不可见），该功能用于配合动画初期布局设计")'>隐藏<button class=bon2 id=huabi onmousemove='showhelp("左键点击目标图形，修改与学习目标图形相关的VML源码")'>改源码</button>
<tr><td>
<select style="width:45;font-size:11px" id=bibiancudu><option>1px<script>temp1="";for(i=2;i<101;i++){temp1+="<option>"+i+"px"}document.write(temp1)</script></select><input style='border:1 solid gray;border-right:0;width:45;height:19' value='black' id=huabiyanse onmousedown='rndcolor(this.id)'><input style='border:1 solid gray;border-right:0;width:45;height:19;' value='white' id=huabibeijing onmousedown='rndcolor(this.id)'><input readonly value='0,0' id=zuobiao style='border:1 solid gray;text-Align:center;width:106;height:19;color:red;font-size:11px'>
</td><td>

</td></tr></table>
<script>gongjulan1.style.left=document.body.offsetWidth/2-(gongjulan1.offsetWidth/2)</script>

<script>jiazai("属性页、全局工具、系统工具")</script>
<TABLE cellspacing=0 cellpadding=1 align=center style='position:absolute;left:1014;top:1;z-index:2999' onmousedown='if(event.srcElement.tagName=="CENTER"&&event.button==1){moveok=1;setCapture();xx=event.x-this.offsetLeft;yy=event.y-this.offsetTop;}' onmousemove="if(moveok==1){this.style.left=event.x-xx;this.style.top=event.y-yy;}" onmouseup='moveok=0;releaseCapture();if(parseInt(this.style.top)<-10){alert("工具栏高度不能低于页面最顶部");this.style.top=1}if(event.srcElement.tagName=="CENTER"&&event.button==2){this.style.zIndex==2999?this.style.zIndex=6000:this.style.zIndex=2999;}' id=gongjulan2>
<tr><Td><center id=cen>属性设置(2)</td></tr><Tr><Td>
<span id=huxing1 style=display:none>
<p><center style='width:100%;height:100%;cursor:move'>弧形专用工具</center><br>
创建基本弧形 <input type=radio name=huxing2 checked><br>
修改弧缺起点 <input type=radio name=huxing2><br>
修改弧缺终点 <input type=radio name=huxing2><br>
</span>
<span id=tianchong1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>填充效果设置</center><br>
填充亮度 <select style=width:54 id=beijingliangdu><script>temp1="";for(i=0.1;i<1;i+=0.1){temp1+="<option>"+i.toFixed(1)};document.write(temp1);beijingliangdu.options[4].selected=true</script></select><br>
<font id=xiaolei>使用普通背景</font><input type=radio name=whattianchong checked><br>
普通背景 <input style='border:1 solid black;width:55;height:17;' value='#0000FF' id=tianchongbeijing onmousedown='rndcolor(this.id)'><br>
<font id=xiaolei>使用渐变背景</font><input type=radio name=whattianchong><br>
基本颜色 <input style='border:1 solid black;width:55;height:17;' value='#FFFFFF' id=jianbianse1 onmousedown='rndcolor(this.id)'><br>
过度颜色 <input style='border:1 solid black;width:55;height:17;color:red' value='#FF0000' id=jianbianse2 onmousedown='rndcolor(this.id)'><br>
折射渐变 <input type=radio name=jianbianyangshi><br>
平行渐变 <input type=radio name=jianbianyangshi checked><br>
平行角度 <select style=width:54 id=pingxingjiaodu><script>temp1="";for(i=-360;i<365;i+=5){temp1+="<option>"+i};document.write(temp1);pingxingjiaodu.options[72].selected=true</script></select><br>
<font id=xiaolei>设置背景图片</font><input type=radio name=whattianchong><br>
<font id=xiaolei>完全空心化</font> <input type=radio name=whattianchong><br>
</span>
<span id=liti1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>立体效果设置</center><br>
立体颜色 <input style='border:1 solid black;width:54;height:17;' value='' id=litiyanse  onmousedown='rndcolor(this.id)'><br>
立体亮度 <select style=width:54 id=litiliangdu><script>temp1="";for(i=0.1;i<3;i+=0.1){temp1+="<option>"+i.toFixed(1)};document.write(temp1);litiliangdu.options[10].selected=true</script></select><br>
后向伸展 <select style=width:54 id=houxiangshenzhan><option>0<script>document.write(temp101);houxiangshenzhan.options[15].selected=true</script></select><br>
前向伸展 <select style=width:54 id=qianxiangshenzhan><option>0<script>document.write(temp101)</script></select><br>
<font id=xiaolei>增加立体效果</font><input type=radio name=whatliti checked onclick="whatliti1=0"><br>
<font id=xiaolei>3 D 角度旋转</font><input type=radio name=whatliti onclick="whatliti1=1"><br>
<font id=xiaolei>取消立体效果</font><input type=radio name=whatliti onclick="whatliti1=2">
</span>
<span id=biankuang1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>边框效果设置</center><br>
边框粗度 <select style=width:54 id=biankuangcudu><option>0<script>document.write(temp101);biankuangcudu.options[1].selected=true</script></select><br>
边框亮度 <select style=width:54 id=biankuangliangdu><script>temp1="";for(i=0.1;i<1;i+=0.1){temp1+="<option>"+i.toFixed(1)};document.write(temp1);biankuangliangdu.options[9].selected=true</script></select><br>
边框样式 <select style=width:54 id=biankuangyangshi><option>none<option>dash<option>dashdot<option>dot<option>longdash<option>longdashdot<option>shortdash<option>shortdashdot<option>shortdashdotdot<option>longdashdotdot<option>shortdot</select><br>
起点箭头 <select style=width:54 id=qidianjiantou><option>none<option>block<option>classic<option>diamond<option>open<option>oval</select><br>
终点箭头 <select style=width:54 id=zhongdianjiantou><option>none<option>block<option>classic<option>diamond<option>open<option>oval</select><br>
箭头大小 <select style=width:54 id=jiantoudaxiao><option>max<option selected>normal<option>min</select><br>
边框颜色 <input style='border:1 solid black;width:54;height:17;' id=biankuangyanse onmousedown='rndcolor(this.id)'><br>
</span>
<span id=yinying1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>阴影效果设置</center><br>
左右偏移 <select style=width:54 id=zuoyoupianyi><script>temp1="";for(i=-50;i<51;i++){temp1+=("<option>"+i)}document.write(temp1);zuoyoupianyi.options[55].selected=true</script></select><br>
上下偏移 <select style=width:54 id=shangxiapianyi><script>temp1="";for(i=-50;i<51;i++){temp1+=("<option>"+i)}document.write(temp1);shangxiapianyi.options[55].selected=true</script></select><br>
阴影颜色 <input style='border:1 solid black;width:54;height:17;' id=yinyingyanse onmousedown='rndcolor(this.id)'><br>
阴影亮度 <select style=width:54 id=yinyingliangdu><script>temp1="";for(i=0.01;i<1.01;i+=0.01){temp1+=("<option value='"+i+"'>"+i.toFixed(2));}document.write(temp1);yinyingliangdu.options[79].selected=true</script></select><br>
<font id=xiaolei>取消阴影处理</font><input type=checkbox id=quxiaoyinying><br>
</span>
<span id=touming1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>滤镜效果设置</center><br>
<select id=toumingxishu><option>不使用透明度<script>temp1="";for(i=100;i>-1;i--){temp1+=("<option>"+i)}document.write(temp1);</script></select><br>
<select id=toumingyangshi><option value=0>默认透明样式<option value=1>左右渐淡<option value=2>圆形渐淡<option value=3>矩形渐淡</select><br>
<select id=mohudu><option>不使用模糊度<script>document.write(temp101)</script></select><br>
<select id=niuqudu><option>不使用扭曲度<script>document.write(temp101)</script></select><br>
<select id=guanghuidu><option>不使用光辉度<script>document.write(temp101)</script></select><br>
光辉颜色 <input value="#FF0000" style='border:1 solid black;width:54;height:17;' id=guanghuiyanse onmousedown='rndcolor(this.id)'><br>
<input type=checkbox onclick="if(this.checked){xray.checked=false;invert.checked=false;light.checked=false}" id=gray><label for=gray>黑白</label> <input type=checkbox id=xray onclick="if(this.checked){gray.checked=false;invert.checked=false;light.checked=false}"><label for=xray>X 光</label><br><input type=checkbox id=invert onclick="if(this.checked){gray.checked=false;xray.checked=false;light.checked=false}"><label for=invert>反彩</label> <input type=checkbox id=light onclick="if(this.checked){gray.checked=false;xray.checked=false;invert.checked=false;}"><label for=light>黑洞</label><br>
<font id=xiaolei>取消滤镜处理</font><input type=checkbox name=quxiaolvjing><br>
</span>
<span id=suofang1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>缩放效果设置</center><br>
比例差 <select style=width:67 id=suofangbili><option>取消缩放<script>temp1="";for(i=0.1;i<9.9;i+=0.1){temp1+=("<option value='"+i+"'>"+i.toFixed(1));}document.write(temp1);suofangbili.options[20].selected=true</script></select><br>
<input type=button value='缩放说明' onclick='alert("缩放功能说明:\n\n介绍1:缩放功能基于CSS的zoom属性控制目标图形按指定比例缩放大小\n介绍2:因为使用[铅笔/多边形/文字]绘制出的图形不能用[调大小/放大/缩小]控制\n介绍3:所以此时应使用缩放功能控制[铅笔/多边形/文字]所绘图形的比例\n注意:一旦矢量化缩放了目标图形，目标图形的实际大小与您看到的并不一致\n     实际大小依旧基于CSS的width/height属性\n     因此，在您再想使用诸如[调大小]命令处理该缩放过的图形时     \n     会出现一些误差现象，不在像未缩放前那样自如\n     所以，但凡目标图形能够支持[调大小/放大/缩小]的操作就不要对其用[缩放]\n     不过也没关系，在比例差中选取[取消缩放]即可将缩放过的图形还原\n\n一次性全部图形缩放与取消缩放\n\n如果图形太多，而你又想一次性的全部缩放与取消缩放\n你可以用鼠标直接点击画布(只要鼠标下没有图形元素)即可")' class=bon3 style=width:110>
</span>
<span id=wenzihua1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>文字化效果设置</center><br>
文字缩放占满 <input type=checkbox checked id=wenzizhanman><br>
文字大小 <select style=width:54 id=wenzidaxiao2><script>document.write(temp101);wenzidaxiao2.options[49].selected=true</script></select><br>
文字背景 <input style='border:1 solid black;width:54;height:17;' id=wenziyanse2 onmousedown='rndcolor(this.id)' value='#FFFFFF'><br>
文字边框 <input style='border:1 solid black;width:54;height:17;' id=wenziyanse3 onmousedown='rndcolor(this.id)' value='#FF0000'><br>
字体 <select style=width:80 id=ziti2><script>document.write(zitistr)</script></select><br>
<font id=xiaolei>取消文字化</font> <input type=checkbox id=quxiaowenzihua><br>
</span>
<span id=qianbi1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>铅笔专用工具</center><br>
Shape形 <input type=radio name=xuanzeqianbi checked><br>
PolyLine形 <input type=radio name=xuanzeqianbi><br>
<input type=button value='选择铅笔说明' onclick='alert("Shape形铅笔简介(适合多数用户):\n\n优点1:绘图时位置定位良好，没有位移情况\n优点2:生成的原代码字数相对较少\n特殊1:旋转、立体角度根据起点为准\n特殊2:对CSS的width/height支持，不过必须搭配coordsize属性\n\nPolyLine形铅笔简介(适合特殊用户):\n\n缺点1:绘图时，位置定位有误差，必须借助[选移]功能辅助定位\n缺点2:生成的原代码字数相对较多\n缺点3:不支持CSS的width/height属性\n特殊1:旋转、立体角度根据图形中心为准")' class=bon3 style=width:110><br>
允许有背景 <input type=checkbox id=qianbibeijing><br>
</span>
<span id=yincang1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>隐藏效果设置</center><br>
隐藏目标图形 <input type=radio name=isyincang checked><br>
取消目标隐藏 <input type=radio name=isyincang><br>
</span>
<span id=jiyixian22 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>多边形专用工具</center><br>
Shape形 <input type=radio name=whatjiyixian checked onclick="if(poly1!=null&&whatjiyixian1!=0){alert('任务未结束，无法更改');whatjiyixian[1].checked=true;return false}whatjiyixian1=0"><br>
PolyLine形 <input type=radio name=whatjiyixian onclick="if(poly1!=null&&whatjiyixian1!=1){alert('任务未结束，无法更改');whatjiyixian[0].checked=true;return false}whatjiyixian1=1"><br>
<input type=button value='选择线条说明' onclick='alert("Shape形线条简介(适合多数用户):\n\n优点1:绘图设计时速度、效率较高\n特殊1:旋转、立体角度根据起点为准\n特殊2:对CSS的width/height支持，不过必须搭配coordsize属性\n\nPolyLine形线条简介(适合特殊用户):\n\n缺点1:绘图设计时速度、效率较低\n缺点2:不支持CSS的width/height属性\n特殊1:旋转、立体角度根据图形中心为准")' class=bon3 style=width:110><br>
允许有背景 <input type=checkbox id=jiyixianbeijing checked><br>
终止时填补 <input type=checkbox id=tianbu checked><br>
<input type=button value='填补说明' onclick='alert("终止时填补说明:\n\n当使用[多边形]绘图时，绘制出了满意形状后，按鼠标右键即终止记忆连接绘图\n此时如果选定了[终止时填补]的话按下鼠标右键，会自动创建最后一条与起点对齐的终止线")' class=bon3 style=width:110>
</span>
<span id=quxian1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>贝塞曲专用工具</center><br>
允许有背景 <input type=checkbox id=quxianbeijing><br>
绘制新曲线 <input type=radio name=isquxian checked onclick="isquxian1=0;"><br>
调整曲度一 <input type=radio name=isquxian onclick="isquxian1=1;if(buzhou!=0){alert('任务未结束，无法更改');isquxian[0].checked=true;isquxian1=0;}"><br>
调整曲度二 <input type=radio name=isquxian onclick="isquxian1=2;if(buzhou!=0){alert('任务未结束，无法更改');isquxian[0].checked=true;isquxian1=0;}">
</span>
<span id=yuanjuxing1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>弧形专用工具</center><br>
圆角弧度 <select style=width:57 id=yuanjiaohudu><script>temp1="";for(i=0.00;i<0.51;i+=0.01){temp1+=("<option value='"+i+"'>"+i.toFixed(2));}document.write(temp1);yuanjiaohudu.options[15].selected=true</script></select>
</span>
<span id=tupian2 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>图片专用工具</center><br>
插入新的图片 <input type=radio checked name=whattupian><br>
修改目标图片 <input type=radio name=whattupian><br>
<select id=liangdu onchange="if(liangdu.selectedIndex==0){tempimg.blacklevel=''}else{tempimg.blacklevel=this.options[this.selectedIndex].text}"><option>默认明亮度<script>temp1="";for(i=-0.4;i<0.41;i+=0.01){temp1+="<option>"+new Number(i).toFixed(2)};document.write(temp1)</script></select><br>
<select id=duibidu onchange="if(duibidu.selectedIndex==0){tempimg.gain='1'}else{tempimg.gain=this.options[this.selectedIndex].text}"><option>默认对比度<script>document.write(temp101)</script></select><br>
<select id=secaidu onchange="if(secaidu.selectedIndex==0){tempimg.gamma=''}else{tempimg.gamma=this.options[this.selectedIndex].text}"><option>默认色彩度<script>temp1="";for(i=0.9;i>0.1;i-=0.1){temp1+="<option>"+new Number(i).toPrecision(1)}document.write(temp1)</script></select><br>
漫画卡通效果 <input type=checkbox id=katong onclick="this.checked?tempimg.bilevel=true:tempimg.bilevel=false"><br>
</span>
<span id=wenzi2 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>文字专用工具</center><br>
插入新的文本 <input type=radio checked name=whatwenzi><br>
修改目标文本 <input type=radio name=whatwenzi><br>
</span>
<span id=xuanzhuan1 style=display:none>
<br><center style='width:100%;height:100%;cursor:move'>旋转专用工具</center><br>
旋转目标图形 <input type=radio name=whatxuanzhuan checked onclick="whatxuanzhuan1=0"><br>
取消目标旋转 <input type=radio name=whatxuanzhuan onclick="whatxuanzhuan1=1"><br>
</span>
</td></tr>
<tr><Td><center id=cen>全局操作(8)</td></tr><Tr><Td>
<input type=button value='撤消' onclick='chexiao_get()' class=bon3 id=chexiaock onmousemove='showhelp("快捷键Ctrl+Z")'><input type=button value='反撤消' onclick='chexiao_get2()' class=bon3 id=fanchexiaock onmousemove='showhelp("快捷键Ctrl+Y")'><br>
<input type=button value='左移' onclick='if(!caozuook())return false;for(i=0;i<div1.all.length;i++){try{div1.all[i].style.left=parseInt(div1.all[i].style.left)-10;}catch(e){}}' class=bon3 id=zuoyi onmousemove='showhelp("快捷键←")'><input type=button value='右移' onclick='if(!caozuook())return false;for(i=0;i<div1.all.length;i++){try{div1.all[i].style.left=parseInt(div1.all[i].style.left)+10;}catch(e){}}' class=bon3 id=youyi onmousemove='showhelp("快捷键→")'><br>
<input type=button value='上移' onclick='if(!caozuook())return false;for(i=0;i<div1.all.length;i++){try{div1.all[i].style.top=parseInt(div1.all[i].style.top)-10;}catch(e){}};' class=bon3 id=shangyi onmousemove='showhelp("快捷键↑")'><input type=button value='下移' onclick='if(!caozuook())return false;for(i=0;i<div1.all.length;i++){try{div1.all[i].style.top=parseInt(div1.all[i].style.top)+10;}catch(e){}}return false' class=bon3 id='xiayi' onmousemove='showhelp("快捷键↓")'><br>
<input type=button value='试运行' onclick='yunxingfun()' class=bon3 id=shiyunxing onmousemove='showhelp("快捷键回车键")'><input type=button value='全部清除' onclick='quanbuqingchu()' class=bon3 id=esc onmousemove='showhelp("快捷键ESC")'>
</td></tr>
<Tr><Td><center id=cen>系统功能(9)</td></tr>
<tr><Td>
<input type=button value='查看及修改源码' onmousemove='showhelp("把已保存的VML代码粘贴修改实现打开,或者手写修改当前编辑器内的所有VML代码")' class=bon3 style=width:110 onclick="chakandaima()"><br>
<input type=button value='FlashVml设置' class=bon3 style='width:110;color:black' id='fvmlshezhi' onclick='yuandaima.style.display="none";temp1=huabutab.width.replace("%","");huaban_daxiao1.options[(temp1/100)-1].selected=true;huaban_yanse1.value=huaban_yanse;huaban_biaoti1.value=huaban_biaoti;huaban_zuidahua1.checked=huaban_zuidahua;huaban_gundongtiao1[huaban_gundongtiao].checked=true;huaban_gundongbase1.value=huaban_gundongbase;huaban_cookies1[huaban_cookies].checked=true;huaban_huanying1.checked=huaban_huanying;huaban_scroll1.checked=huaban_scroll;huaban_tishi1.checked=huaban_tishi;huaban_juzhenwid1.value=huaban_juzhenwid;huaban_juzhenhei1.value=huaban_juzhenhei;huaban_juzhencolor1.value=huaban_juzhencolor;huaban_juzhen1.checked=huaban_juzhen;for(i=0;i<huaban_wangge1.options.length;i++){if(huaban_wangge1.options[i].text==huaban_wangge)huaban_wangge1.options[i].selected=true}huaban_wanggese1.value=huaban_wanggese;huabanshezhi.style.display==""?huabanshezhi.style.display="none":huabanshezhi.style.display=""' onmousemove='showhelp("打开画板设置选项卡，设置画板设计、运行时的各项指标")'><br>
<input type=button value='保存为文件' onmousemove='showhelp("将编辑器图形保存为后缀为htm的文件,注意保存时请使用Unicode保存")' class=bon3 style=width:110 onclick="savefile()"><br>
<input type=button value='播放作业录像' onmousemove='showhelp("FlashVml特有的录像功能，动态的以你指定的速度(毫秒)播放您整个绘图过程")' class=bon3 style=width:110 onclick="luxiang()"><br>
<input type=button value='关于FlashVml' class=bon3 style='width:110;color:red' onclick=guanyukai()>
</td></tr></table>

<table cellspacing=0 cellpadding=0 style='position:absolute;width:100;height:100;display:none;z-index:60000' id=colortab><tr><td id=colorid></td></tr></table>

<script language='jscript'>
gongjulan2.style.left=document.body.offsetWidth-gongjulan2.offsetWidth-20
jiazai("界面加载完毕，核心程序(变量、全局函数)")
var open_var="vml" 
var bi=4   
var bitext=""  
var color1='#000000',color2='#000000',size1="" 
var xx=0,yy=0,zz=3000 
var moveobj=null,ckleft=0,cktop=0,ckwid=0,ckhei=0,ckto="" 
var poly1=null,oldvalue="",oldx=0,oldy=0 
var whatqianbi=1,whathuxing=1 
var morenxuanzhuan=0 
var huxingqidian=0,huxingzhongdian=0 
var gaojiobj=null,gaojiobjdex=0,shijianobj=null 
var thisobj=null  
var zz2=3000         
var huxingtixing=false,fuzhitixing=false 
var yincangtixing1=false,yincangtixing2=false 
var chexiao=new Array(),youbiao=0,fanchexiao1=2 
var zuizhongxingtai=""  
var objorthis=""  
var diplaytime=null  
var wodejiaoben="function fun1(){\n\n}\n"   
var nextid=-1
var whodonghua=true  
var miaoarray=new Array() 
var dianchi=0  
var dianchitxt=new Array() 
var dianchitime1=new Array() 
var dianchitime2=new Array() 
var dianchitime3=new Array() 
dianchitime1[0]=1;dianchitime2[0]=20;dianchitime3[0]=5 
var luxianghaomiao=300 
var worktime=0 
var buzhou=0,oldto="" 
var whatcaijian=1,caijianoldx=0,caijianoldy=0,caijianoldwid=0,caijianoldhei=0 
var clips=new Array(0,0,0,0) 
var caijianjuli=5,caijianbu=25 
var zuobiaotime=null 
var yunxuchexiao=true 
var isquxian1=0,quxianduanx=0,quxianduany=0 
var whatjiyixian1=0
var whatliti1=0,litioldx=0,litioldy=0 
var whatxuanzhuan1=0 
function changsts(){ 
window.status="Work "+huaban_biaoti+" use FlashVml "+worktime+" minutes,VmlElements "+div1.children.length+"("+getformatvml(div1.innerHTML).length+" Codes)"
}
function getallid(){  
try{oldselindex=allid.options[allid.selectedIndex].text}catch(e){}
var oparray=new Array(),oparrayops=0,oldaryindex=0
oplen=allid.options.length
for(i=oplen;i>0;i--)allid.remove(i)
for(i=0;i<div1.children.length;i++){
if(div1.children[i].id!=""){oparray[oparrayops]=div1.children[i].id;oparrayops++}
}
oparray.sort();temp1=oparray.length
for(i=0;i<temp1;i++){
if(i<temp1-1){
if(oparray[i]==oparray[i+1]){oparray[i]+="["+oldaryindex+"]";oldaryindex++}
}
if(oldaryindex!=0&&oparray[i].indexOf("[")==-1){oparray[i]+="["+oldaryindex+"]";oldaryindex=0;}
var tempoption=new Option(oparray[i])
if(oparray[i].indexOf("[")!=-1)tempoption.style.color="red"
allid.add(tempoption)
}
for(i=0;i<allid.options.length;i++){
if(allid.options[i].text==oldselindex){allid.options[i].selected=true;break}
}
}
function biaoshifun(textid1){  
if(textid1!="可用的对象ID"){
var textid2=eval(textid1);biaoshijuli=1
biaoshi.style.left=textid2.offsetLeft-biaoshijuli;
biaoshi.style.top=textid2.offsetTop-biaoshijuli;
biaoshi.style.width=textid2.offsetWidth+(biaoshijuli*2);
biaoshi.style.height=textid2.offsetHeight+(biaoshijuli*2);
biaoshi.style.display="";
if(diplaytime!=null)clearTimeout(diplaytime)
diplaytime=setTimeout('biaoshi.style.display="none"','2000')
}}
function caozuook(){ 
if(caijian.style.display=="")return false
if(gaoji1.style.display=="")return false
if(menu1.style.display=="")return false
if(beijingtupian1.style.display=="")return false
if(shijian1.style.display=="")return false
if(yunxuchexiao==false||moveobj!=null||poly1!=null){return false}else return true
}
function chexiao_get(){ 
if(!caozuook())return false
if(youbiao>0){div1.innerHTML=chexiao[youbiao];youbiao-=1;fanchexiao1=2}
}
function chexiao_get2(){ 
if(!caozuook())return false
if(youbiao<chexiao.length-fanchexiao1){youbiao+=fanchexiao1;fanchexiao1=1;div1.innerHTML=chexiao[youbiao];}else if(chexiao.length-youbiao==1&&youbiao>0){div1.innerHTML=zuizhongxingtai}
}
function addnextid(){ 
if(yesaddnextid.checked==true){nextid++;return " id='"+open_var+nextid+"'"}else{return ""}
}
function statstime(endtimestrings1){ 
if(endtimestrings1==""){
return ""
}else{return "<script>\nvar exptime=0;endtime="+endtimestrings1+";zhenlens=0;zhenlens2=0;\nfunction statusreplace(){window.status=\"The FlashVml Play Time\\\'s \"+exptime+endtime+\" Seconds,An animation:\"+zhenlens+\",Milli-an animation:\"+zhenlens2}\nfunction statuschange(){\nif(top.location==self.location)setInterval('exptime++;statusreplace()',1000)\n}\n;;;/script>\n"}
}
jiazai("界面加载完毕，核心程序(画布绘图程序)")
function div1.onmousedown(){
colortab.style.display="none";caijian.style.display="none";yuandaima.style.display="none" 
zuobiao.style.color="blue";menu1.style.display='none';menu2.style.display='none'
if(event.button==2){gaoji1.style.display="none";shijian1.style.display="none";beijingtupian1.style.display="none"}
yunxuchexiao=false 
div1.setCapture(); 
color1=huabiyanse.value 
color2=huabibeijing.value; 
size1=bibiancudu.options[bibiancudu.selectedIndex].text 
bodyscrollleft=document.body.scrollLeft 
bodyscrolltop=document.body.scrollTop
xx=bodyscrollleft+event.x;yy=bodyscrolltop+event.y;zz+=1 
for(i=0;i<huabi.length;i++){if(huabi[i].className=="bon1"){bi=i;if(huabi[i].ps==null)bitext=huabi[i].innerText;else bitext=huabi[i].ps;break}} 

line1.strokecolor=color1;line1.strokeweight=size1;oval1.strokeweight=size1;oval1.strokecolor=color1  
oval1.fillcolor=color2;rect1.strokeweight=size1;rect1.strokecolor=color1
rect1.fillcolor=color2;roundrect1.strokeweight=size1;roundrect1.strokecolor=color1
roundrect1.fillcolor=color2;arc1.strokeweight=size1;arc1.strokecolor=color1
arc1.fillcolor=color2;
ebj=event.srcElement
if(event.button==1){
if(bitext=="铅笔"||bitext=="直线"||bitext=="圆形"||bitext=="长方形"||bitext=="圆矩形"||bitext=="弧形"){ 
biaochi1.style.left=xx;biaochi1.style.display="";
biaochi2.style.top=yy;biaochi2.style.left=bodyscrollleft;biaochi2.style.display="";
}
switch(bitext){
case "选移": 
if(ebj.parentElement.id=="div1"){moveobj=ebj;ckleft=xx-parseInt(moveobj.style.left);cktop=yy-parseInt(moveobj.style.top);}
break;
case "调大小": 
if(ebj.parentElement.id=="div1"){
str1=ebj.tagName.toLowerCase()
if(str1=="polyline"||str1=="shape"){
alert('无法调整核心基于'+str1+'图形，请使用[缩放]功能调整其大小\n\n或者使用[改源码]直接修改其源坐标系(需具备专业知识)');yunxuchexiao=true
huabi[bi].className="bon2";
huabisuofang.className="bon1";div1.style.cursor="hand";suofang1.style.display='';return false
}
moveobj=ebj;
ckleft=parseInt(moveobj.style.left);cktop=parseInt(moveobj.style.top);ckwid=moveobj.offsetWidth;ckhei=moveobj.offsetHeight}
break;
case "弧形": 
if(huxing2[0].checked==true){whathuxing=1;arc1.style.left=xx;arc1.style.top=yy;arc1.style.width=0;arc1.style.height=0;arc1.style.display="";}else{
if(ebj.tagName.toLowerCase()!="arc"){
alert('目标图形不是弧形，无法调整');yunxuchexiao=true;whathuxing=2;return false}
for(i=0;i<huxing2.length;i++){if(huxing2[i].checked)whathuxing=i+1}
moveobj=ebj;huxingqidian=moveobj.startangle;huxingzhongdian=moveobj.endangle
}
break;
case "直线": 
line1.style.left=xx;line1.style.top=yy;line1.to="0,0";line1.style.display=""
break;
case "铅笔": 
if(document.getElementsByName('xuanzeqianbi')[0].checked==true){whatqianbi=1}else{whatqianbi=0}
if(poly1==null&&event.button==1){
oldx=xx;oldy=yy
qianbibeijing.checked?str1="t":str1='f'
if(whatqianbi==1){ 
poly1=div1.appendChild(document.createElement("<v:shape path='m0,0 l0,0' filled='" + str1 + "' style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";width:100;height:100' strokecolor='"+color1+"' strokeweight='"+size1+"' coordsize='100,100' fillcolor='"+color2+"'"+addnextid()+"/>"))
oldvalue=poly1.path.value.replace("e","")
}else{ 
poly1=div1.appendChild(document.createElement("<v:polyline filled='"+str1+"' points='0px,0px' style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";' strokecolor='"+color1+"' strokeweight='"+size1+"' fillcolor='"+color2+"'"+addnextid()+"/>"))
oldvalue=poly1.points.value
}}
case "圆形": 
oval1.style.left=xx;oval1.style.top=yy;oval1.style.width=0;oval1.style.height=0;oval1.style.display=""
break;
case "长方形": 
rect1.style.left=xx;rect1.style.top=yy;rect1.style.width=0;rect1.style.height=0;rect1.style.display=""
break;
case "圆矩形": 
roundrect1.outerHTML="<v:roundrect arcsize='"+yuanjiaohudu.options[yuanjiaohudu.selectedIndex].text+"' class=keshi style='display:none;left:"+xx+";top:"+yy+";width:0;height:0;' id='roundrect1' strokecolor='"+color1+"' strokeweight='"+size1+"' fillcolor='"+color2+"'><v:Stroke dashstyle='dashdot'/></v:roundrect>"
roundrect1.style.display=''
break;
case "文字": 
if(whatwenzi[0].checked){
wenzi1.style.left=xx;wenzi1.style.top=yy-20;charu1.value="插入";wenzi1.style.display=""
}else{
if(ebj.tagName.toLowerCase()!="textbox"){alert("目标不是Textbox文本对象，无法修改");yunxuchexiao=true;return false}
txt1.value=ebj.innerHTML.replace(/( <BR>|<BR>)/g,"\n");gaojiobj=ebj;wenzi1.style.left=xx;wenzi1.style.top=yy;charu1.value="修改";wenzi1.style.display=""
}
break;
case "图片": 
if(whattupian[0].checked){
tupian1.style.left=xx;tupian1.style.top=yy;tupian1.style.display=""
}else{
if(ebj.tagName.toLowerCase()!="image"){alert("目标不是Image图片对象，无法修改");yunxuchexiao=true;return false}
ebj.blacklevel=tempimg.blacklevel;ebj.gain=tempimg.gain;ebj.gamma=tempimg.gamma;ebj.bilevel=tempimg.bilevel
}
break;
case "多边形": 
if(poly1==null){
if(jiyixianbeijing.checked)temp1="t";else temp1="f"
if(whatjiyixian1==1){
oldx=xx;oldy=yy
div1.innerHTML+="<v:polyline filled='"+temp1+"' points=\"0pt 0pt\" style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";' strokecolor='"+color1+"' fillcolor='"+color2+"' strokeweight='"+size1+"'"+addnextid()+"/>";poly1=div1.lastChild;oldvalue="0pt 0pt"
}else{
poly1=div1.appendChild(document.createElement("<v:shape path='m0,0 l0,0' filled='"+temp1+"' style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";width:100;height:100' strokecolor='"+color1+"' strokeweight='"+size1+"' coordsize='100,100' fillcolor='"+color2+"'"+addnextid()+"/>"))
oldvalue=poly1.path.value.replace("e","")
oldx=xx;oldy=yy
}
}else{
if(whatjiyixian1==1)oldvalue=poly1.points.value;else {oldvalue=poly1.path.value.replace(" e","");}
}
break;
case "旋转":
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"textbox")==false)return false;
if(whatxuanzhuan1==0){
moveobj=ebj;
if(moveobj.style.rotation==''||moveobj.style.rotation==null){moveobj.style.rotation=0}
morenxuanzhuan=parseInt(moveobj.style.rotation)}
}
break;
case "贝塞曲": 
if(buzhou==0&&poly1==null){
if(isquxian1==0){
oldx=xx;oldy=yy
quxianbeijing.checked?str1='t':str1='f'
poly1=div1.appendChild(document.createElement("<v:curve filled='"+str1+"' to='0,0' style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";' strokecolor='"+color1+"' fillcolor='"+color2+"' strokeweight='"+size1+"'"+addnextid()+"/>"));return false}
if(ebj.tagName.toLowerCase()!='curve'){alert('目标图形不是曲线，无法调整');yunxuchexiao=true;return false}
moveobj=ebj;oldx=xx;oldy=yy
if(isquxian1==1)str1=ebj.control1;
if(isquxian1==2)str1=ebj.control2;
str1=new String(str1).split(",")
quxianduanx=parseInt(str1[0]);quxianduany=parseInt(str1[1])
}
break;
case "立体": 
if(ebj.parentElement.id=="div1"){
if(whatliti1==1){
if(ebj.extrusion.on!=true){alert("目标未增加立体效果，无法修改");yunxuchexiao=true;return false}
if(ebj.extrusion.rotationangle=="")ebj.extrusion.rotationangle="0,0"
str1=ebj.extrusion.rotationangle;str1=new String(str1).split(",")
litioldy=parseInt(str1[0]);litioldx=parseInt(str1[1])
moveobj=ebj
}}
break;
}
}}
function div1.onmousemove(){
tempx=bodyscrollleft+event.x;tempy=bodyscrolltop+event.y;
ebn=event.button
if(zuobiaotime==null){
if(ebn==0){zuobiaotime=setTimeout("zuobiao.value='X'+tempx+',Y'+tempy;zuobiaotime=null;clearTimeout(zuobiaotime)",100)}
else if(ebn==1){ 
tempx>xx?jiajians1="+":jiajians1="-";tempy>yy?jiajians2="+":jiajians2="-";
zuobiaotime=setTimeout("zuobiao.value='"+xx+jiajians1+Math.abs(tempx-xx)+","+yy+jiajians2+Math.abs(tempy-yy)+"';zuobiaotime=null;clearTimeout(zuobiaotime)",100)}
}
if(poly1!=null){
if(bitext=="铅笔"&&ebn==1){  
if(whatqianbi==1){ 
oldvalue=oldvalue+","+(tempx-xx)+","+(tempy-yy);poly1.path.value=oldvalue
poly1.path.value=poly1.path.value.replace(",0,",",").replace(",0 e","e")
}else{
oldvalue=oldvalue+","+(tempx-oldx)+","+(tempy-oldy);poly1.points.value=oldvalue
}
}
else if(bitext=="多边形"){  
if(whatjiyixian1==1){
div1.lastChild.outerHTML=div1.lastChild.outerHTML.replace(/ points = \".*?\"/,' points=\"'+oldvalue+","+(tempx-oldx)+","+(tempy-oldy)+'\"');poly1=div1.lastChild
}else{
poly1.path.value=oldvalue+","+(tempx-oldx)+","+(tempy-oldy)
poly1.path.value=poly1.path.value.replace(",0,0,",",0,").replace(",0 e","e")
}
}
else if(bitext=="贝塞曲"){ 
if(buzhou==1){oldto=(tempx-oldx)+","+(tempy-oldy);poly1.to=oldto}
if(buzhou==2){poly1.control1=(tempx-oldx)+","+(tempy-oldy);}
if(buzhou==3){poly1.control2=(tempx-oldx)+","+(tempy-oldy)}
}}
if(ebn==1){
switch(bitext){
case "贝塞曲": 
if(moveobj!=null){
if(isquxian1==1){try{moveobj.control1=(quxianduanx+(tempx-oldx))+"pt,"+(quxianduany+(tempy-oldy))+"pt";}catch(e){}}
if(isquxian1==2){try{moveobj.control2=(quxianduanx+(tempx-oldx))+"pt,"+(quxianduany+(tempy-oldy))+"pt";}catch(e){}}
}
break;
case "选移": 
if(moveobj!=null){moveobj.style.left=tempx-ckleft;moveobj.style.top=tempy-cktop}
break;
case "调大小": 
if(moveobj!=null){
if(moveobj.tagName=="curve"){moveobj.to=parseInt(tempx-ckleft)+","+parseInt(tempy-cktop);
if(ckto=="")ckto=parseInt(tempx-ckleft)+","+parseInt(tempy-cktop);return false}
if(moveobj.tagName!="line"){
if(tempx>ckleft){moveobj.style.width=tempx-ckleft}else{moveobj.style.left=tempx;moveobj.style.width=ckleft-tempx}
if(tempy>cktop){moveobj.style.height=tempy-cktop}else{moveobj.style.top=tempy;moveobj.style.height=cktop-tempy}
}else{
moveobj.to=parseInt(tempx-ckleft)+","+parseInt(tempy-cktop);
if(ckto=="")ckto=parseInt(tempx-ckleft)+","+parseInt(tempy-cktop);}
}
break;
case "弧形": 
if(whathuxing==1){
if(tempx-xx<0){arc1.style.left=tempx;arc1.style.width=(xx-tempx)}else{arc1.style.width=(tempx-xx)}
if(tempy-yy<0){arc1.style.top=tempy;arc1.style.height=(yy-tempy)}else{arc1.style.height=(tempy-yy)}
}else if(whathuxing==2){ 
sjj=huxingqidian+(tempx-xx)
if(sjj>-360&&sjj<360)moveobj.startangle=sjj
}else if(whathuxing==3){
sjj=huxingzhongdian+(tempx-xx)
if(sjj>-360&&sjj<360)moveobj.endangle=sjj
}
break;
case "直线": 
line1.to=(tempx-xx)+","+(tempy-yy)
break;
case "圆形": 
if(tempx-xx<0){oval1.style.left=tempx;oval1.style.width=(xx-tempx)}else{oval1.style.width=(tempx-xx)}
if(tempy-yy<0){oval1.style.top=tempy;oval1.style.height=(yy-tempy)}else{oval1.style.height=(tempy-yy)}
break;
case "长方形": 
if(tempx-xx<0){rect1.style.left=tempx;rect1.style.width=(xx-tempx);}else{rect1.style.width=(tempx-xx)}
if(tempy-yy<0){rect1.style.top=tempy;rect1.style.height=(yy-tempy);}else{rect1.style.height=(tempy-yy)}
break;
case "圆矩形": 
if(tempx-xx<0){roundrect1.style.left=tempx;roundrect1.style.width=(xx-tempx)}else{roundrect1.style.width=(tempx-xx)}
if(tempy-yy<0){roundrect1.style.top=tempy;roundrect1.style.height=(yy-tempy)}else{roundrect1.style.height=(tempy-yy)}
break;
case "旋转": 
if(moveobj!=null&&whatxuanzhuan1==0){moveobj.style.rotation=morenxuanzhuan+(tempx-xx)}
break;
case "立体": 
if(moveobj!=null){moveobj.extrusion.rotationangle=(litioldy+(tempy-yy))+","+(litioldx+(tempx-xx))}
}}}
function div1.onmouseup(){
yunxuchexiao=true 
savechexiao()
document.releaseCapture();
zuobiao.style.color="red";biaochi1.style.display="none";biaochi2.style.display="none"
tempx=bodyscrollleft+event.x;tempy=bodyscrolltop+event.y;
if(bitext=="贝塞曲")moveobj=null
if(bitext=="贝塞曲"&&poly1!=null){
if(event.button==2){
if(buzhou==1)poly1.removeNode()
poly1=null;buzhou=0;oldto="";return false}
if(buzhou==1){poly1.control1=oldto;poly1.control2=oldto;}
if(buzhou==3){poly1=null;buzhou=0;oldto=""}else{buzhou++;}
}
if(bitext=="铅笔"&&poly1!=null){
if(whatqianbi==1){ 
poly1.path.value=oldvalue;
poly1.path.value=poly1.path.value.replace(",0,",",").replace(",0 e","e")
oldvalue="";poly1=null;
}else{
poly1.points.value=oldvalue;oldvalue="";poly1=null;
div1.innerHTML=div1.innerHTML
}
}else if(event.button==2&&poly1==null&&moveobj==null){ 
if(event.srcElement.parentElement.id=="div1"){menu2.style.display='none';menu1.style.left=tempx;menu1.style.top=tempy;menu1.style.display='';thisobj=event.srcElement;}else{menu1.style.display='none';menu2.style.left=tempx;menu2.style.top=tempy;menu2.style.display='';}
}else if(event.button==2&&bitext=="多边形"&&poly1!=null){
if(whatjiyixian1==1){
if(tianbu.checked==false){
div1.lastChild.outerHTML=div1.lastChild.outerHTML.replace(/ points = \".*?\"/,' points=\"'+oldvalue+'\"');
}else{div1.lastChild.outerHTML=div1.lastChild.outerHTML.replace(/ points = \".*?\"/,' points=\"'+oldvalue+',0,0\"');}
}else{
if(tianbu.checked==false){
poly1.path.value=oldvalue+" e";
}else{poly1.path.value=oldvalue+"x e";}
}
oldvalue='';poly1=null
}
if(event.button==1){
var ebj=event.srcElement
switch(bitext){
case "选移": 
moveobj=null
break;
case "调大小": 
moveobj=null;ckto=""
break;
case "弧形": 
if(whathuxing==1){
arc1.style.display='none';
if (Math.abs(tempx-xx)<=1||Math.abs(tempy-yy)<=1)return false
div1.appendChild(document.createElement("<v:arc startangle='360' endangle='30' style='position:absolute;z-index:"+zz+";left:"+arc1.style.left+";top:"+arc1.style.top+";width:"+arc1.style.width+";height:"+arc1.style.height+";' strokecolor='"+color1+"' strokeweight='"+size1+"' fillcolor='"+color2+"'"+addnextid()+"/>"))
if(huxingtixing==false){huxingtixing=true;alert("弧形已绘出,调整弧度请使用[修改弧缺起点/修改弧形终点]功能");huxing2[1].checked=true}
}
else{moveobj=null}
break;
case "直线": 
line1.style.display="none"
if (Math.abs(tempx-xx)<=2&&Math.abs(tempy-yy)<=2)return false
div1.appendChild(document.createElement("<v:line style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";' to='"+(tempx-xx)+","+(tempy-yy)+"' strokecolor='"+color1+"' strokeweight='"+size1+"'"+addnextid()+"/>"))
break;
case "圆形": 
oval1.style.display="none"
if (Math.abs(tempx-xx)<=1||Math.abs(tempy-yy)<=1)return false
div1.appendChild(document.createElement("<v:oval style='position:absolute;z-index:"+zz+";left:"+oval1.style.left+";top:"+oval1.style.top+";width:"+oval1.style.width+";height:"+oval1.style.height+";' strokecolor='"+color1+"' strokeweight='"+size1+"' fillcolor='"+color2+"'"+addnextid()+"/>"))
break;
case "长方形": 
rect1.style.display="none"
if (Math.abs(tempx-xx)<=1||Math.abs(tempy-yy)<=1)return false
div1.appendChild(document.createElement("<v:rect style='position:absolute;z-index:"+zz+";left:"+rect1.style.left+";top:"+rect1.style.top+";width:"+rect1.style.width+";height:"+rect1.style.height+";' strokecolor='"+color1+"' strokeweight='"+size1+"' fillcolor='"+color2+"'"+addnextid()+"/>"))
break;
case "圆矩形": 
roundrect1.style.display="none"
if (Math.abs(tempx-xx)<=1||Math.abs(tempy-yy)<=1)return false
div1.appendChild(document.createElement("<v:roundrect style='position:absolute;z-index:"+zz+";left:"+roundrect1.style.left+";top:"+roundrect1.style.top+";width:"+roundrect1.style.width+";height:"+roundrect1.style.height+";' strokecolor='"+color1+"' arcsize='"+yuanjiaohudu.options[yuanjiaohudu.selectedIndex].text+"' strokeweight='"+size1+"' fillcolor='"+color2+"'"+addnextid()+"/>"))
break;
case "填充": 
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"image,line,textbox")==false)return false
if(whattianchong[0].checked){
ebj.fillcolor=tianchongbeijing.value;ebj.filled=true
if(ebj.fill.type!='frame'&&ebj.fill.type!='tile')ebj.fill.type='frame'
}else if(whattianchong[1].checked){ 
ebj.filled=true
temp1=jianbianyangshi[1].checked?'gradient':'gradientradial'
ebj.fillcolor=jianbianse2.value
ebj.fill.color2=jianbianse1.value
ebj.fill.type=temp1
if(temp1=='gradient')ebj.fill.angle=pingxingjiaodu.options[pingxingjiaodu.selectedIndex].text
}else if(whattianchong[2].checked){ 
gaojiobj=ebj
beijingtupian1.style.left=xx;beijingtupian1.style.top=yy;beijingtupian1.style.display="";return false
}
ebj.fill.opacity=beijingliangdu.options[beijingliangdu.selectedIndex].text
if(whattianchong[3].checked){ebj.filled=false;}
}
break;
case "立体": 
if(whatliti1==1)moveobj=null 
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"image,textbox")==false)return false
if(whatliti1==2){ebj.extrusion.on=false}
else if(whatliti1==0){
ebj.extrusion.color=litiyanse.value
ebj.extrusion.backdepth=houxiangshenzhan.options[houxiangshenzhan.selectedIndex].text
ebj.extrusion.foredepth=qianxiangshenzhan.options[qianxiangshenzhan.selectedIndex].text
ebj.extrusion.diffusity=litiliangdu.options[litiliangdu.selectedIndex].text
ebj.extrusion.on=true}
}
break;
case "边框": 
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"textbox")==false)return false
ebj.strokecolor=biankuangyanse.value
if(biankuangcudu.options[biankuangcudu.selectedIndex].text=='0'){ebj.stroked=false}else{ebj.stroked=true;ebj.strokeweight=biankuangcudu.options[biankuangcudu.selectedIndex].text+"px"}
ebj.stroke.dashstyle=biankuangyangshi.options[biankuangyangshi.selectedIndex].text
ebj.stroke.startarrow=qidianjiantou.options[qidianjiantou.selectedIndex].text
ebj.stroke.endarrow=zhongdianjiantou.options[zhongdianjiantou.selectedIndex].text
ebj.stroke.opacity=biankuangliangdu.options[biankuangliangdu.selectedIndex].text
str1=jiantoudaxiao.selectedIndex
if(ebj.stroke.startarrow!='none'){
if(str1==0){
ebj.stroke.startarrowwidth="wide";ebj.stroke.startarrowlength="long"
}else if(str1==2){
ebj.stroke.startarrowwidth="narrow";ebj.stroke.startarrowlength="short"
}else{
ebj.stroke.startarrowwidth="medium";ebj.stroke.startarrowlength="medium"
}}
if(ebj.stroke.endarrow!='none'){
if(str1==0){
ebj.stroke.endarrowwidth="wide";ebj.stroke.endarrowlength="long"
}else if(str1==2){
ebj.stroke.endarrowwidth="narrow";ebj.stroke.endarrowlength="short"
}else {
ebj.stroke.endarrowwidth="medium";ebj.stroke.endarrowlength="medium"
}}
}
break;
case "隐藏": 
if(ebj.parentElement.id=="div1"){
if(isyincang[0].checked){
ebj.yincang="true";if(!yincangtixing1){yincangtixing1=true;alert('目标图形已被隐藏（仅设计时可见，运行时将不可见）')}
}else{
ebj.removeAttribute("yincang");if(!yincangtixing2){yincangtixing2=true;alert('目标图形已取消隐藏（设计、运行时均可见）')}
}}
break;
case "改源码": 
if(ebj.parentElement.id=="div1"){
gaojiobj=ebj;gaojiobjdex=ebj.sourceIndex
txt2.value=getformatvml(ebj.outerHTML);
zishu2.innerText=txt2.value.length
if(ebj.style.cursor==""){shubiaozhuangtai.options[0].selected=true}else{
for(i=0;i<shubiaozhuangtai.options.length;i++){
if(shubiaozhuangtai.options[i].value==ebj.style.cursor)shubiaozhuangtai.options[i].selected=true
}}
if(ebj.title==""){tishibiaoti.value=""}else{tishibiaoti.value=ebj.title}
tagnametext.innerText=ebj.tagName
objcss[0].value=ebj.style.width.replace("px","");objcss[1].value=ebj.style.height.replace("px","");
objcss[2].value=ebj.style.zIndex;objcss[3].value=ebj.style.left.replace("px","");
objcss[4].value=ebj.style.top.replace("px","");
ebj.yincang!=null?yiyincang.innerText="是":yiyincang.innerText="否"
ebj.print==true?printok.checked=true:printok.checked=false
gaoji1.style.left=tempx;gaoji1.style.top=tempy;gaoji1.style.display=''
}
break;
case "文字化": 
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"image,textbox")==false)return false
switch(ebj.tagName.toLowerCase()){
case "shape":case "polyline":case "line":case "curve":case "arc":
if(ebj.path.textpathok==true){alert("[文字化]对基于shape/polyline/line/curve/arc结构的图形，只能使用一次\n\n目标图形已使用过一次，若想修改，必须使用[改源码]功能手工修改\n\n这是VML的硬性规定。");return false}
break;
}
if(quxiaowenzihua.checked){
ebj.innerHTML=ebj.innerHTML.replace(/<v\:path .*<\/v:path>/gi,'').replace(/<v\:textpath .*<\/v:textpath>/gi,'')
}else{
str1=prompt("请输入一段用于图形轨迹填充的文字(支持中文)",ebj.textpath.string)
if(!str1)return false;if(str1=='')return false
if(str1.indexOf("'")!=-1)return alert("输入的文字中不可含有违禁符号 ' 单引号")
ebj.filled=true
ebj.fillcolor=wenziyanse2.value
ebj.strokecolor=wenziyanse3.value
wenzizhanman.checked?htemp1="t":htemp1="f"
ziti2.selectedIndex==0?tempziti="font-family:宋体;":tempziti="font-family:"+ziti2.options[ziti2.selectedIndex].text+";"
temp2=ebj.innerHTML.replace(/<v\:path .*<\/v:path>/gi,'').replace(/<v\:textpath .*<\/v:textpath>/gi,'')
ebj.innerHTML=temp2+"<v:path textpathok='True'/>\n<v:textpath fitpath='"+htemp1+"' on='True' style='font-size:"+wenzidaxiao2.options[wenzidaxiao2.selectedIndex].text+"px;"+tempziti+"' string='"+str1+"'/>"
}}
break;
case "阴影": 
if(ebj.parentElement.id=="div1"){
if(nouse(ebj,"textbox")==false)return false;
if(quxiaoyinying.checked){
ebj.shadow.on=false
}else{
ebj.shadow.offset=zuoyoupianyi.options[zuoyoupianyi.selectedIndex].text+"px,"+shangxiapianyi.options[shangxiapianyi.selectedIndex].text+"px"
ebj.shadow.color=yinyingyanse.value
ebj.shadow.opacity=yinyingliangdu.options[yinyingliangdu.selectedIndex].text
ebj.shadow.on=true}
}
break;
case "滤镜": 
if(ebj.parentElement.id=="div1"){
if(quxiaolvjing.checked){ebj.style.filter="";return false}
str1=""
if(toumingxishu.selectedIndex!=0)str1="alpha(opacity="+toumingxishu.options[toumingxishu.selectedIndex].text+",style="+toumingyangshi.options[toumingyangshi.selectedIndex].value+")"
if(mohudu.selectedIndex!=0)str1+=" blur(add=0,direction=14,strength="+mohudu.options[mohudu.selectedIndex].text+")"
if(niuqudu.selectedIndex!=0)str1+=" wave(add=0,freq=,lightstrength=5,phase=5,strength="+niuqudu.options[niuqudu.selectedIndex].text+")"
if(guanghuidu.selectedIndex!=0)str1+=" glow(color="+guanghuiyanse.value+",strength="+guanghuidu.options[guanghuidu.selectedIndex].text+")"
if(gray.checked)str1+=" gray";if(xray.checked)str1+=" xray";if(invert.checked)str1+=" invert";
if(light.checked)str1+=" light";
ebj.style.filter=str1
}
break;
case "缩放": 
if(ebj.parentElement.id=="div1"){
str1=suofangbili.options[suofangbili.selectedIndex].text
str1=="取消缩放"?ebj.style.zoom=null:ebj.style.zoom=str1
}else{
if(!confirm("当前鼠标指针下没有固定目标，你是想一次性缩放控制所有的图形？"))return false
str1=suofangbili.options[suofangbili.selectedIndex].text
str1=="取消缩放"?str1=null:str1=str1
for(i=0;i<div1.children.length;i++){div1.children[i].style.zoom=str1}
}
break;
case "旋转": 
moveobj=null;
if(ebj.parentElement.id=="div1"&&whatxuanzhuan1!=0)ebj.style.rotation='';
break;
case "定义ID": 
if(ebj.parentElement.id=="div1"){
str1=prompt("请设置当前目标的ID名称用以标识,简化编程时的目标控制\nID格式必须是英文或英文+数字,格式如:obj、obj1、oval1\n允许多个图形使用同一个ID名称",ebj.id)
if(str1!=null){
if(ebj.id!=str1){
if(str1.replace(/\w+/g,"").length!=0){alert('ID名称必须使用英文或英文+数字的格式!此次更新无效');return false}
ebj.id=str1;getallid()
}
}}
break;
case "增加": 
if(ebj.parentElement.id=="div1"){
objorthis="this";tempstr1="";shijianobj=ebj
if(eval('ebj.temp_on'+selectshijian.value)!=null)shijiantxt.value=eval('ebj.temp_on'+selectshijian.value);else shijiantxt.value=""
chengxu1[0].style.display='';chengxu1[1].style.display='none';
shijian1.style.left=tempx;shijian1.style.top=tempy;shijian1.style.display=""
}else{alert('光标下没有图形，无法进行事件编程')}
break;
}zuizhongxingtai=div1.innerHTML;}}
function document.onmouseup(){ 
var ebj=event.srcElement
if(ebj.tagName=="BUTTON"&&event.button==1){
ebj.blur();if(ebj.className=="bon1")return true;
for(i=0;i<huabi.length;i++)if(huabi[i].className!="bon2"){huabi[i].className="bon2";break;}
ebj.className="bon1";
oldbitext=bitext
if(ebj.ps==null)bitext=ebj.innerText;else bitext=ebj.ps

switch(bitext){ 
case "调大小":case "旋转":div1.style.cursor="move";break;
case "多边形":case "铅笔":case "贝塞曲":div1.style.cursor="default";break;
case "直线":case "圆形":case "长方形":case "圆矩形":case "弧形":div1.style.cursor="crosshair";break;
default:div1.style.cursor="hand"
}
bitext=="隐藏"?yincang1.style.display='':yincang1.style.display='none'
bitext=="铅笔"?qianbi1.style.display='':qianbi1.style.display='none'
bitext=="多边形"?jiyixian22.style.display='':jiyixian22.style.display='none'
bitext=="贝塞曲"?quxian1.style.display='':quxian1.style.display='none'
bitext=="弧形"?huxing1.style.display='':huxing1.style.display='none'
bitext=="缩放"?suofang1.style.display='':suofang1.style.display='none'
bitext=="文字化"?wenzihua1.style.display='':wenzihua1.style.display='none'
bitext=="填充"?tianchong1.style.display='':tianchong1.style.display='none'
bitext=="圆矩形"?yuanjuxing1.style.display='':yuanjuxing1.style.display='none'
bitext=="图片"?tupian2.style.display='':tupian2.style.display='none'
bitext=="文字"?wenzi2.style.display='':wenzi2.style.display='none'
bitext=="旋转"?xuanzhuan1.style.display='':xuanzhuan1.style.display='none'
bitext=="滤镜"?touming1.style.display='':touming1.style.display='none'
if(bitext=="立体"){liti1.style.display='';litiyanse.value=litiyanse.value==''?huabibeijing.value:litiyanse.value}else{liti1.style.display='none';}
if(bitext=="边框"){biankuang1.style.display='';biankuangyanse.value=biankuangyanse.value==''?huabiyanse.value:biankuangyanse.value}else{biankuang1.style.display='none';}
if(bitext=="阴影"){yinying1.style.display='';yinyingyanse.value=yinyingyanse.value==''?huabiyanse.value:yinyingyanse.value}else{yinying1.style.display='none';}
if(poly1!=null){
poname=poly1.tagName.toLowerCase()
if(oldbitext=="多边形"){  
if(poname=="polyline"){div1.lastChild.outerHTML=div1.lastChild.outerHTML.replace(/ points = \".*?\"/,' points=\"'+oldvalue+'\"');oldvalue='';poly1=null}else{poly1.outerHTML="";oldvalue="";poly1=null;}
}else if(oldbitext=="贝塞曲"){  
poly1.outerHTML="";oldvalue="";poly1=null;buzhou=0
}
}
huxing2[0].checked=true; 
isquxian[0].checked=true;isquxian1=0
whatwenzi[0].checked=true;whattupian[0].checked=true
isyincang[0].checked=true

beijingtupian1.style.display='none';
wenzi1.style.display='none';tupian1.style.display='none';gaoji1.style.display='none';
shijian1.style.display='none';jiaoben.style.display='none';
colortab.style.display="none";caijian.style.display="none";yuandaima.style.display="none" 
menu1.style.display='none';menu2.style.display='none'
}}
jiazai("界面加载完毕，核心程序(动画处理、可视化设计程序)")
function donghuachengxu(whoid){
objorthis=whoid
shijianobj=eval(whoid);tempstr1=""
if(whodonghua==true){ 
temptext1=miaoarray[parseInt(miaozhong.options[miaozhong.selectedIndex].text)]
if(temptext1!=null){shijiantxt.value=temptext1}else{shijiantxt.value=""}
chengxu1[0].style.display='';chengxu1[1].style.display='none';
}else{ 
temptext1=dianchitxt[dianchi];if(temptext1!=null){shijiantxt.value=temptext1}else{shijiantxt.value=""}
chengxu1[0].style.display='none';chengxu1[1].style.display='';
}
shijian1.style.left=bodyscrollleft+170;shijian1.style.top=bodyscrolltop+270;shijian1.style.display=""
}
function shijianfun(){  
shijian1.style.display='none'
tempcolor1="yellow"
if(shijiantxt.value==''){str1=null}else{str1=shijiantxt.value}
if(objorthis!="this"){ 
if(str1!=null)str1=str1.replace(/\n/g,'').replace(/\r/g,'').replace(/\f/g,'') 
if(whodonghua==true){ 
miao1=parseInt(miaozhong.options[miaozhong.selectedIndex].text)
miaoarray[miao1]=str1
str1==null?temp1="white":temp1=tempcolor1
miaozhong.options[miaozhong.selectedIndex].style.backgroundColor=temp1
return false;
}else{ 
dianchitxt[dianchi]=str1;dianchitime1[dianchi]=qishimiao.value
dianchitime2[dianchi]=haomiaobuchang.value;dianchitime3[dianchi]=jieshumiaozhong.value
str1==null?temp1="white":temp1=tempcolor1
dianchi1.options[dianchi1.selectedIndex].style.backgroundColor=temp1
return false
}}
if(bitext=="增加"){  
eval('shijianobj.temp_on'+selectshijian.value+'=shijiantxt.value')
}
}
function savechexiao(){ 
youbiao+=1;chexiao[youbiao]=div1.innerHTML;
}
function rndcolor(theobjis){ 
if(event.button==2)return false
colortab.style.display="";colorid.innerHTML="";str1="<table cellspacing=0 cellpadding=0>";
colortab.style.left=document.body.scrollLeft+event.x-100;colortab.style.top=document.body.scrollTop+event.y+event.srcElement.offsetHeight+15;
for(r=0;r<10;r++){str1+="<tr>"
for(i=0;i<10;i++){
tempcolor1=Math.round(Math.random()*255).toString(16)+Math.round(Math.random()*255).toString(16)+Math.round(Math.random()*255).toString(16);while(tempcolor1.length<6){tempcolor1+=Math.round(Math.random()*9)}
str1+="<td style='width:10;height:10;background-color:#"+tempcolor1+";' onclick="+theobjis+".value='#"+tempcolor1+"';"+theobjis+".style.color='#"+tempcolor1+"';colortab.style.display='none';></td>"
}str1+="</tr>"}
colorid.innerHTML=str1+"<tr><td colspan=20 align=center onclick=colortab.style.display='none' style='cursor:hand'>Close(关闭)</td></tr></table>"
}
function charuwenzi(){  
if(txt1.value=="")return alert('文本内容不能为空！')
if(charu1.value=="插入"){
wenzibiankuang.checked==true?thebiankuang="border:1 solid black;":thebiankuang=""
beijingtouming.checked==true?bkcolor1="":bkcolor1="background-color:"+wenzibeijing.value
wenziziti.selectedIndex==0?zititemp='font-family:宋体;':zititemp="font-family:"+wenziziti.options[wenziziti.selectedIndex].text+";"
wenzigundongtiao.checked==false?wenziscroll='':wenziscroll="overflow-y:scroll;"
if(zijiange.selectedIndex==0){str1=""}else{str1="letter-Spacing:"+zijiange.options[zijiange.selectedIndex].text+";"}
if(hangjiange.selectedIndex==0){str2=""}else{str2="line-height:"+hangjiange.options[hangjiange.selectedIndex].text+";"}
var newtxt=document.createElement("<v:Textbox print='t' inset='5pt,5pt,5pt,5pt' style='position:absolute;word-Break:break-all;z-index:"+zz+";left:"+xx+";top:"+yy+";color:"+wenziyanse.value+";"+bkcolor1+";font-size:"+wenzidaxiao.options[wenzidaxiao.selectedIndex].text+";"+zititemp+wenziscroll+"text-align:"+duiqi.options[duiqi.selectedIndex].value+";"+str1+str2+thebiankuang+"'"+addnextid()+"></v:Textbox>");newtxt.innerHTML=txt1.value.replace(/\n/g,'<br>').replace(/  /g,' &nbsp;')
div1.appendChild(newtxt);
}else{ 
if(gaojiobj==null){wenzi1.style.display='none';return false}
wenzibiankuang.checked==true?gaojiobj.style.border="1 solid black":gaojiobj.style.border="0"
beijingtouming.checked==true?gaojiobj.style.backgroundColor="":gaojiobj.style.backgroundColor=wenzibeijing.value
zijiange.selectedIndex==0?gaojiobj.style.letterSpacing="":gaojiobj.style.letterSpacing=zijiange.options[zijiange.selectedIndex].text
hangjiange.selectedIndex==0?gaojiobj.style.lineHeight="":gaojiobj.style.lineHeight=hangjiange.options[hangjiange.selectedIndex].text
gaojiobj.style.color=wenziyanse.value
gaojiobj.style.textAlign=duiqi.options[duiqi.selectedIndex].value
gaojiobj.style.fontSize=wenzidaxiao.options[wenzidaxiao.selectedIndex].text
wenziziti.selectedIndex==0?gaojiobj.style.fontFamily='宋体':gaojiobj.style.fontFamily=wenziziti.options[wenziziti.selectedIndex].text
wenzigundongtiao.checked==false?gaojiobj.style.overflowY='hidden':gaojiobj.style.overflowY='scroll'
gaojiobj.innerHTML=txt1.value.replace(/\n/g,'<br>').replace(/  /g,' &nbsp;')
gaojiobj=null
}
wenzi1.style.display='none'
}
function charutupian(){  
if(file1.value=="")return alert('请先输入图片路径(HTTP://或FILE:///)格式，在点击插入')
if(file1.value.indexOf("'")>-1)return alert("图片地址不可以含有违禁字符 ' 单引号")
str1="";
if(duibidu.selectedIndex!=0)str1=" gain='"+tempimg.gain+"'"
if(secaidu.selectedIndex!=0)str1+=" gamma='"+tempimg.gamma+"'"
if(liangdu.selectedIndex!=0)str1+=" blacklevel='"+tempimg.blacklevel+"'"
str1+=" bilevel='"+katong.checked+"'"
var newtxt=document.createElement("<v:Image style='position:absolute;z-index:"+zz+";left:"+xx+";top:"+yy+";width:100;height:100'"+addnextid()+" src='"+file1.value+"'"+str1+"/>");
div1.appendChild(newtxt);tupian1.style.display='none'
}
function charubeijingtupian(){ 
if(file2.value=="")return alert('请先输入背景图片路径(HTTP://或FILE:///)格式，在点击插入')
if(file2.value.indexOf("'")>-1)return alert("背景图片地址不可以含有违禁字符 ' 单引号")
gaojiobj.filled=true
gaojiobj.fill.opacity=beijingliangdu.options[beijingliangdu.selectedIndex].text
ronghebeijing.checked?gaojiobj.fillcolor=tianchongbeijing.value:gaojiobj.fillcolor="white"
beijinglashen[0].checked?gaojiobj.fill.type='frame':gaojiobj.fill.type='tile'
gaojiobj.fill.src=file2.value
gaojiobj.fill.on=true
gaojiobj=null;beijingtupian1.style.display='none'
}
jiazai("界面加载完毕，核心程序(键盘处理、系统程序)")
function document.onkeydown(){  
eshift=event.shiftKey;ectrl=event.ctrlKey;ecode=event.keyCode;
if(event.srcElement.tagName!='TEXTAREA'){
ectrl&&ecode==90?chexiao_get():
ectrl&&ecode==89?chexiao_get2():str1=1;
!ectrl&&ecode==27?esc.click():str1=1
if(event.srcElement.tagName!="INPUT"){
with(document.all){
if(ecode==8)return false
if(!ectrl&&ecode==13){
if(caijian.style.display!="none"){caijian.style.display="none";thisobj=null;return false}
shiyunxing.click()
}

if(caijian.style.display!="none"){tx=parseInt(caijian.style.left);ty=parseInt(caijian.style.top);tw=parseInt(caijian.style.width);th=parseInt(caijian.style.height);objwid=thisobj.offsetWidth;objhei=thisobj.offsetHeight;tmove=1
str1=thisobj.style.clip;
if(str1==""){clips[0]=0;clips[1]=objwid;clips[2]=objhei;clips[3]=0;}else{str1=str1.replace(/[a-z\(\)\%]+/g,'');str1=str1.split(' ');for(i=0;i<3;i++)clips[i]=str1[i];}
}else{tmove=0}

if(!ectrl&&!eshift&&ecode==37){ 
if(tmove==1){
try{
caijian.style.width=tw-caijianbu
clips[1]-=caijianbu;thisobj.style.clip="rect("+clips[0]+" "+clips[1]+" "+clips[2]+" "+clips[3]+")"
}catch(e){caijianerr()}
return false}
zuoyi.click();return false
}
if(!ectrl&&!eshift&&ecode==38){ 
if(tmove==1){
try{
caijian.style.height=th-caijianbu
clips[2]-=caijianbu;thisobj.style.clip="rect("+clips[0]+" "+clips[1]+" "+clips[2]+" "+clips[3]+")"
}catch(e){caijianerr()}
return false}
shangyi.click();return false
}
if(!ectrl&&!eshift&&ecode==39){ 
if(tmove==1){
try{
caijian.style.left=tx+caijianbu;caijian.style.width=tw-caijianbu
clips[3]=parseInt(clips[3])+parseInt(caijianbu);thisobj.style.clip="rect("+clips[0]+" "+clips[1]+" "+clips[2]+" "+clips[3]+")"
}catch(e){caijianerr()}
return false}
youyi.click();return false
}
if(!ectrl&&!eshift&&ecode==40){ 
if(tmove==1){
try{
caijian.style.top=ty+caijianbu;caijian.style.height=th-caijianbu
clips[0]=parseInt(clips[0])+parseInt(caijianbu);thisobj.style.clip="rect("+clips[0]+" "+clips[1]+" "+clips[2]+" "+clips[3]+")"
}catch(e){caijianerr()}
return false}
xiayi.click();return false
}
} 

}}
}
function caijianerr(){ 
clips[0]=0;clips[1]=thisobj.offsetWidth;clips[2]=thisobj.offsetHeight;clips[3]=0;
thisobj.style.clip="rect(0 "+thisobj.offsetWidth+" "+thisobj.offsetHeight+" 0)";
caijian.style.left=thisobj.offsetLeft-caijianjuli;caijian.style.top=thisobj.offsetTop-caijianjuli;caijian.style.width=thisobj.offsetWidth+(caijianjuli*2);caijian.style.height=thisobj.offsetHeight+(caijianjuli*2);
}
function getformatvml(getwhoobj){ 
return getwhoobj.replace(/><v\:/g,'>\n<v:').replace(/ = /g,'=').replace(/\: /g,':').replace(/\; /g,';').replace(/temp_/g,'').replace('<?xml:namespace prefix=v ns="urn:schemas-microsoft-com:vml" />\n','').replace(/ id=\"\"/g,"").replace(/ title=\"\"/g,"").replace(/ coordsize=\"21600,21600\"/g,"").replace(/\"><\/v\:\w+>/g,"\"\/>").replace(/\/><\/v\:/g,'/>\n</v:').replace(/:(\d+)px/g,":$1").replace(/ strokeweight="\.75pt"/g,' strokeweight="1px"')
}
function getallcode(yesgetall){  
timestring1="" 
timestring2=""
endtime=0,theendtime=0,timefunstr=""
for(i=0;i<miaoarray.length;i++){if(miaoarray[i]!=null){timestring1+=('setTimeout("zhenlens++;statusreplace();'+miaoarray[i].replace(/\"/g,'\\\"')+'","'+i+'000");\n');endtime=i*1000}}

if(xunhuan1.checked==true){ 
timestring2='setTimeout("location.reload();",'+(endtime+1000)+');\n'
}else{timestring2=""}
if(timestring1!=""){timestring1="%^&!!script>\nfunction flashvml(){  //以下是侦式动画程序\n"+timestring1+timestring2+"}\n%^&!!/script>\n";flashvmlfunadd="flashvml();\n";}else{flashvmlfunadd=""}

liuxianstr1=""
for(i=0;i<dianchitxt.length+1;i++){
if(dianchitxt[i]!=null){
temp0='FlashVmlIntervalVar'+i+'="zhenlens2++;statusreplace();'+dianchitxt[i].replace(/\"/g,'\\\"')+'";\n'
temp1="FlashVmlIntervalTime"+i+"=setInterval(FlashVmlIntervalVar"+i+","+dianchitime2[i]+")"
temp2="clearInterval(FlashVmlIntervalTime"+i+")"
liuxianstr1+=(temp0+'setTimeout("'+temp1+'",'+(dianchitime1[i]*1000)+');\nsetTimeout("'+temp2+'",'+(dianchitime3[i]*1000)+');\n')
if(dianchitime3[i]*1000>theendtime)theendtime=dianchitime3[i]*1000 
}}
if(liuxianstr1!=""){liuxianstr1="%^&!!script>\n"+dhfun_dizhen.value+"\nfunction flashvml2(){  //以下是流线动画程序\n"+liuxianstr1+"}\n%^&!!/script>\n";flashvml2funadd="flashvml2();\n"}else{flashvml2funadd=""}

statuschangefunadd=""
if(endtime!=0||theendtime!=0){
if(endtime>theendtime){timefunstr='"/'+endtime/1000+'"'}else{timefunstr='"/'+theendtime/1000+'"'}
statuschangefunadd="statuschange();\n"
}
if(pingbicuowu.checked){temp3="<script>\nfunction window.onerror(){return true;}  //防止您的程序出现错误时弹出提示\n;;;/script>\n"+statstime(timefunstr).replace(';;;','<')}else{temp3=statstime(timefunstr).replace(';;;','<')}
if(wodejiaoben=="function fun1(){\n\n}\n"||wodejiaoben==""){str3=temp3}else{str3=temp3.replace(";;;","<")+'<script id=myscript language="javascript">\n'+wodejiaoben+';;;/script>\n'}

if(huaban_gundongtiao==0){gundongstr=" style='scrollbar-base-color:"+huaban_gundongbase+";scrollbar-shadow-color:white;scrollbar-highlight-color:white;scrollbar-arrow-color:white;'"}
else if(huaban_gundongtiao==1){gundongstr=""}
else if(huaban_gundongtiao==2){gundongstr=" scroll=no"}

str1='<HTML xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n<HEAD>\n<META name="Gemeratpr" content="FlashVml(闪耀之星)3.0">\n<META http-equiv="Content-Type" content="text/html;charset=gb2312">\n<META name="KeyWords" content="'+huaban_biaoti.replace(/'/g,"")+keystrs+'">\n<TITLE>'+huaban_biaoti+'</TITLE>\n<STYLE>\nv\\:*{behavior:url(#default#VML);}\no\\:*{behavior:url(#default#VML);}\n</STYLE>\n'+str3.replace(";;;","<")+'</HEAD>\n<BODY bgcolor="'+huaban_yanse+'"'+gundongstr+'>\n<bgsound loop=1 id=bgsound1>\n<bgsound loop=-1 id=bgsound2>\n'+timestring1.replace(/\%\^\&\!\!/g,'<')+liuxianstr1.replace(/\%\^\&\!\!/g,'<')+onloadstr(true).replace(";;;","<")+'\n'
if(yesgetall==true){
return str1+getformatvml(div1.innerHTML)+loadendscript.value
}else{return str1}
}
function yunxingfun(){ 
if(!caozuook())return false
win1=window.open("","lshdic1");win1.document.open()
win1.document.write(getallcode(true));
win1.document.close();
if(huaban_zuidahua==true){win1.moveTo(0,0);win1.resizeTo(screen.availWidth,screen.availHeight)}
win1.focus()
}
function savefile(){  
if(!caozuook())return false
web.document.clear();web.document.open();web.document.write(getallcode(true));web.document.execCommand('SaveAs',false,huaban_biaoti);web.document.clear();web.document.close();web.location.href="about:blank";changsts()
}
function chakandaima(){  
if(!caozuook())return false
huabanshezhi.style.display="none"
txt3_top.value=getallcode(false)
txt3.value=getformatvml(div1.innerHTML);
zishu1[0].innerText=txt3.value.length+txt3_top.value.length;zishu1[1].innerText=txt3.value.length;zishu1[2].innerText=txt3_top.value.length;
yuandaima.style.display==''?yuandaima.style.display='none':yuandaima.style.display=''
}
function quanbuqingchu(){  
if(!caozuook())return false
if(!confirm("这将会清除[所有图形、侦式动画程序、流线动画程序]，但不清空[我的脚本仓库]\n\n你确认要清除吗？"))return false
savechexiao();div1.innerHTML="";poly1=null;thisobj=null;gaoji1.style.display="none"
for(i=allid.options.length;i>0;i--)allid.remove(i);allid.selectedIndex=0
dianchi1.selectedIndex=0;dianchi=0;dianchi1.onchange()
miaolen1=miaoarray.length;dianchisss=dianchitxt.length
temp1="yellow";
try{
for(i=0;i<miaolen1;i++){if(miaoarray[i]!=null)miaozhong.options[i].style.backgroundColor="white"}
}catch(e){}
for(i=0;i<dianchitxt.length;i++){if(dianchitxt[i]!=null)dianchi1.options[i].style.backgroundColor="white"}
dianchitxt.splice(0,dianchisss);miaoarray.splice(0,miaolen1); 
}
luxiangyoubiao=0
function luxiang(){  
if(!caozuook())return false
if(div1.children.length<2){alert('要播放录像，您必须至少绘制2个基本图形');return false}
strs=prompt('请为录像播放定义一个[毫秒步长]，录像将会按照你定义的[毫秒步长]数有规律的刷新、播放，建议范围100-1000，默认为[300]毫秒',luxianghaomiao)
if(strs!=null&&strs!=""){
if(isNaN(strs)){alert('值格式必须为数字！');return false}
if(strs<10||strs>10000){alert('可接受的数值范围为10-10000！');return false}
luxianghaomiao=strs;
str0="<script>\nFlashVmlluxiangyoubiao=3;BodyAllObjectLength=0;luxiangtime1=null;\ndocument.body.style.display='none';\nfunction luxiangstart(){\nBodyAllObjectLength=document.body.children.length;\nfor(i=0;i<BodyAllObjectLength;i++){document.body.children[i].style.display='none'}\ndocument.body.style.display='';\nluxiangtime1=setInterval('if(FlashVmlluxiangyoubiao<BodyAllObjectLength){document.body.children[FlashVmlluxiangyoubiao].style.display=\"\";}else{FlashVmlluxiangyoubiao=3;BodyAllObjectLength=0;clearInterval(luxiangtime1);setTimeout(\"luxiangstart()\",2000);return false}FlashVmlluxiangyoubiao++',"+strs+");\n}\n;;;/script>\n"
str1='<HTML xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n<HEAD>\n<META name="Gemeratpr" content="FlashVml(闪耀之星)3.0">\n<META http-equiv="Content-Type" content="text/html;charset=gb2312">\n<META name="KeyWords" content="'+huaban_biaoti.replace(/'/g,"")+keystrs+'">\n<TITLE>'+huaban_biaoti+' - 教学录像回放</TITLE>\n<STYLE>\nv\\:*{behavior:url(#default#VML);}\no\\:*{behavior:url(#default#VML);}\n</STYLE>\n'+statstime("").replace(';;;','<')+'</HEAD>\n<BODY bgcolor="'+huaban_yanse+'">\n<bgsound loop=1 id=bgsound1>\n<bgsound loop=-1 id=bgsound2>\n'+onloadstr(false).replace("}\n;;;","\nluxiangstart();\n}\n<")+'\n'+str0.replace(';;;','<')+getformatvml(div1.innerHTML)+'</BODY>\n</HTML>'
win1=window.open("","lshdic1");win1.document.open()
win1.document.write(str1);
win1.document.close();win1.moveTo(0,0);win1.resizeTo(screen.availWidth,screen.availHeight);win1.focus()
}}
function nouse(nouseobj,nousetag){  
nouseobjtagname=nouseobj.tagName.toLowerCase();nostr1=nousetag.split(",");
for(i=0;i<nostr1.length;i++)if(nouseobjtagname==nostr1[i]){alert("["+bitext+"]功能该"+nouseobjtagname+"对象无法使用");return false}
}
</script>
<v:roundrect id=showdiv style="Z-INDEX:50010;LEFT:0;POSITION:absolute;TOP:0;width:300;HEIGHT:25px;display:none;text-align:left" arcsize=".4" filled="t" fillcolor="#C4F6FA" stroked="t" strokecolor="#ddd" strokeweight=".75pt" onmousemove='this.style.display="none"'>
<v:fill type="gradient" opacity=".5" color2="white"/>
<v:Textbox id=showdiv2 style="filter:alpha(opacity=60);FONT-SIZE:12px;FONT-FAMILY:宋体;color:purple;white-Space:nowrap;table-Layout:fixed;" inset="3pt,3pt,0pt,0pt"></v:Textbox>
</v:roundrect>
<script>
var oldtext="加速变量",thetemp1=0,closetime
function showhelp(thetext){
if(huaban_tishi==false)return false
try{
ebj=event.srcElement
if(ebj.tagName=="BUTTON"){
if(ebj.ps!=null){temp1=ebj.ps}else{temp1=ebj.innerText}
}else{
if(ebj.value!=null)temp1=ebj.value;else return false
}
if(thetemp1!=temp1||showdiv.style.display=="none"){
thetemp1=temp1
clearTimeout(closetime)
bodyscrollleft=document.body.scrollLeft
bodyscrolltop=document.body.scrollTop
if(showdiv.style.display=='none'){showdiv.style.left=bodyscrollleft+event.x-3;showdiv.style.top=event.y+bodyscrolltop+18;}
oldtext=thetext;
showdiv2.innerHTML="<B>"+temp1+":</b>"+thetext;

if(event.x>document.body.offsetWidth/2){
if(thetext.indexOf('<br>')!=-1){
showdiv.style.left=bodyscrollleft+event.x-(oldtext.length*13)/1.6;showdiv.style.top=event.y+bodyscrolltop+28;
}else{
showdiv.style.left=bodyscrollleft+event.x-(oldtext.length*15);showdiv.style.top=event.y+bodyscrolltop+28;
}
}else{showdiv.style.left=bodyscrollleft+event.x-3;showdiv.style.top=event.y+bodyscrolltop+18;}
if(thetext.indexOf('<br>')!=-1){
showdiv.style.width=((oldtext.length*12)+60)/1.6;showdiv.style.height="40px"
}
else{
showdiv.style.width=(oldtext.length*13)+90;showdiv.style.height=25
}

showdiv.style.display=''
closetime=setTimeout('showdiv.style.display="none"',5000)
}
}catch(e){}
}
</script>