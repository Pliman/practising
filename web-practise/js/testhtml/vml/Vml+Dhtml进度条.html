<HTML xmlns:v>
<HEAD>
<META http-equiv=Content-Type content=text/html;charset=gb2312>
<Meta name=Gemeratpr content=网络程序员伴侣(Lshdic)2004>
<TITLE>效果不错的<a href="index.php?op=article&action=keyword&keyword=VML">VML</a><a href="index.php?op=article&action=keyword&keyword=进度">进度</a>条</TITLE>
<STYLE>
v:*{behavior:url(#default#<a href="index.php?op=article&action=keyword&keyword=VML">VML</a>);}
*{font-size:12px;color:;}
</STYLE>
</HEAD>
<BODY topmargin=2 leftmargin=2>
<div style=table-Layout:fixed;width:100%;height:100%;border:1 solid black>
<v:RoundRect id=a style=position:absolute;left:300;top:250;height:29;>
<v:Textbox inset=5px,5px,5px><b><font color=red id=jindu></font></b></v:textbox>
<v:fill type=gradient id=fill1 color=blue/>
</v:RoundRect>
</div>
<script>
//原作:风云舞,载自:<A href="http://www.lshdic.com/bbs" target=_blank>http://www.lshdic.com/bbs</A>
var pos1=1,posall=200  //定义全局变量,pos1为当前<a href="index.php?op=article&action=keyword&keyword=进度">进度</a>,posall为总<a href="index.php?op=article&action=keyword&keyword=进度">进度</a>
function play1(){ //播放函数
if(pos1<posall)pos1+=1;else{pos1=1;fill1.color="rgb("+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+")"}
a.style.width=Math.round(300/(posall/pos1));jindu.innerText=pos1+"/"+posall+","+Math.round(100/(posall/pos1))+"%"
fill1.angle=Math.round(300/(posall/pos1))
}
setInterval("play1()",10) //10毫秒播放一次，一般CPU保证能消化~~~
</script>
</BODY>
</HTML>
